<div id="topico13" class="slides-container">
    <!-- SLIDE 1: TÃ­tulo do Projeto -->
    <div class="slide active">
        <h2><span class="emoji">ğŸš€</span>TÃ³pico 13: Projeto PrÃ¡tico - RelatÃ³rio AnalÃ­tico</h2>
        <h3>Do zero a um relatÃ³rio profissional com Python!</h3>
        <p style="font-size: 1.1em; margin: 20px 0;">
            Vamos aplicar tudo o que aprendemos para construir uma automaÃ§Ã£o que resolve um problema de negÃ³cio real.
        </p>

        <div class="destaque">
            <strong>ğŸ¯ Objetivo do projeto:</strong>
            <p style="margin-top: 10px;">
                Criar um script que lÃª uma planilha de vendas e gera automaticamente um relatÃ³rio analÃ­tico completo em Excel.
            </p>
            <ol style="margin-top: 10px;">
                <li>ğŸ“– <strong>LÃª e prepara</strong> os dados de um arquivo <code>.xlsx</code>.</li>
                <li>ğŸ“Š <strong>Realiza anÃ¡lises</strong> automÃ¡ticas de negÃ³cio (vendas por cidade, produto, etc.).</li>
                <li>ğŸ’¾ <strong>Cria um arquivo Excel</strong> profissional com mÃºltiplas abas.</li>
                <li>ğŸ“ˆ <strong>Adiciona um grÃ¡fico</strong> diretamente na planilha.</li>
            </ol>
        </div>

        <div class="exemplo-box">
            <strong>ğŸ’¼ CenÃ¡rio:</strong>
            <p>VocÃª precisa analisar os dados de vendas e apresentar os resultados para a gerÃªncia de forma clara e rÃ¡pida, todo mÃªs.</p>
        </div>
    </div>

    <!-- SLIDE 2: Estrutura e PreparaÃ§Ã£o -->
    <div class="slide">
        <h2><span class="emoji">ğŸ› ï¸</span>PreparaÃ§Ã£o e Estrutura do Projeto</h2>
        <h3>Antes de comeÃ§ar, vamos garantir que temos tudo pronto.</h3>
        
        <div class="code-block">
            <code># 1. Instalar as bibliotecas necessÃ¡rias
pip install pandas openpyxl

# 2. Estrutura do nosso script
# ETAPA 1: Leitura e PreparaÃ§Ã£o dos Dados
#   - Carregar o arquivo .xlsx
#   - Converter colunas e criar campos Ãºteis (mÃªs, preÃ§o unitÃ¡rio)

# ETAPA 2: AnÃ¡lise de NegÃ³cio com Pandas
#   - Usar groupby para agrupar e resumir dados
#   - Calcular faturamento por cidade, produto, status e mÃªs

# ETAPA 3: GeraÃ§Ã£o do RelatÃ³rio Multi-abas
#   - Usar o pd.ExcelWriter para salvar cada anÃ¡lise em uma aba

# ETAPA 4: Adicionar um GrÃ¡fico (BÃ´nus)
#   - Usar openpyxl para inserir um grÃ¡fico no relatÃ³rio final

print("âœ… Tudo pronto para comeÃ§ar a automaÃ§Ã£o!")</code>
        </div>
         <div class="destaque">
            <strong>ğŸ’¡ Dica:</strong> Organizar o cÃ³digo em etapas lÃ³gicas torna o desenvolvimento e a manutenÃ§Ã£o muito mais fÃ¡ceis.
        </div>
    </div>

    <!-- SLIDE 3: Etapa 1 - Leitura e PreparaÃ§Ã£o dos Dados -->
    <div class="slide">
        <h2><span class="emoji">ğŸ“–</span>Etapa 1: Leitura e PreparaÃ§Ã£o dos Dados</h2>
        <h3>A base de uma boa anÃ¡lise Ã© ter dados limpos e bem estruturados.</h3>

        <div class="code-block">
            <code>import pandas as pd

# Define os nomes dos arquivos
arquivo_entrada = 'dados_vendas.xlsx'
arquivo_saida = 'relatorio_analitico_vendas.xlsx'

print("--- ETAPA 1: Lendo e preparando os dados ---")
df = pd.read_excel(arquivo_entrada)

# Converter a coluna 'data' para o formato de data
# Isso Ã© ESSENCIAL para qualquer anÃ¡lise de tempo!
df['data'] = pd.to_datetime(df['data'])

# Calcular o preÃ§o unitÃ¡rio (valor / quantidade)
df['preco_unitario'] = (df['valor'] / df['quantidade']).round(2)

# Extrair o mÃªs da venda para facilitar a agregaÃ§Ã£o posterior
df['mes'] = df['data'].dt.strftime('%Y-%m') # Formato: 2024-10

print("âœ… Dados lidos e preparados com sucesso!")
print("Novas colunas criadas: 'preco_unitario', 'mes'")
print("\nPrÃ©via dos dados tratados:")
print(df.head())</code>
        </div>
    </div>

    <!-- SLIDE 4: Etapa 2 - AnÃ¡lise de NegÃ³cio -->
    <div class="slide">
        <h2><span class="emoji">ğŸ§ </span>Etapa 2: A MÃ¡gica do `groupby`</h2>
        <h3>Ã‰ aqui que transformamos dados brutos em inteligÃªncia de negÃ³cio.</h3>

        <div class="code-block">
            <code>print("\n--- ETAPA 2: Realizando anÃ¡lises de negÃ³cio ---")

# 1. AnÃ¡lise: Faturamento por cidade
vendas_por_cidade = df.groupby('cidade')['valor'].sum().sort_values(ascending=False).reset_index()

# 2. AnÃ¡lise: Vendas por status (ConcluÃ­da, Pendente, Cancelada)
vendas_por_status = df.groupby('status')['valor'].sum().sort_values(ascending=False).reset_index()

# 3. AnÃ¡lise: Performance dos produtos (por quantidade e faturamento)
vendas_por_produto = df.groupby('produto').agg(
quantidade_total=('quantidade', 'sum'),
faturamento_total=('valor', 'sum')
).sort_values(by='faturamento_total', ascending=False).reset_index()

# 4. AnÃ¡lise: Faturamento mensal
vendas_mensais = df.groupby('mes')['valor'].sum().reset_index()

print("âœ… AnÃ¡lises de negÃ³cio concluÃ­das!")
print("\nExemplo - Vendas por Cidade:")
print(vendas_por_cidade)</code>
        </div>
    </div>
    
    <!-- SLIDE 5: Etapa 3 - Gerando o RelatÃ³rio -->
    <div class="slide">
        <h2><span class="emoji">ğŸ’¾</span>Etapa 3: Gerando um RelatÃ³rio Profissional</h2>
        <h3>Vamos criar um arquivo Excel com uma aba para cada anÃ¡lise.</h3>

        <div class="code-block">
            <code>print("\n--- ETAPA 3: Gerando relatÃ³rio Excel com mÃºltiplas abas ---")

# O ExcelWriter permite escrever em vÃ¡rias abas no mesmo arquivo
with pd.ExcelWriter(arquivo_saida, engine='openpyxl') as writer:
# Aba 1: Dados completos e tratados
df.to_excel(writer, sheet_name='Dados Consolidados', index=False)

# Aba 2: AnÃ¡lise por cidade
vendas_por_cidade.to_excel(writer, sheet_name='Vendas por Cidade', index=False)

# Aba 3: AnÃ¡lise de produtos
vendas_por_produto.to_excel(writer, sheet_name='Performance dos Produtos', index=False)

# Aba 4: Dashboard com resumos
vendas_por_status.to_excel(writer, sheet_name='Dashboard Resumo', startrow=0, startcol=0, index=False)
vendas_mensais.to_excel(writer, sheet_name='Dashboard Resumo', startrow=0, startcol=4, index=False)

print(f"âœ… RelatÃ³rio '{arquivo_saida}' criado com 4 abas!")</code>
        </div>
         <div class="destaque">
            <strong>ğŸ’¡ Por que usar <code>ExcelWriter</code>?</strong>
            <p style="margin-top:5px;">Ele "mantÃ©m o arquivo Excel aberto" enquanto seu cÃ³digo roda, permitindo que vocÃª adicione vÃ¡rias planilhas (abas) uma apÃ³s a outra.</p>
        </div>
    </div>

    <!-- SLIDE 6: Etapa 4 - Adicionando GrÃ¡fico -->
    <div class="slide">
        <h2><span class="emoji">ğŸ“ˆ</span>Etapa 4 (BÃ´nus): Adicionando GrÃ¡fico ao Excel</h2>
        <h3>Vamos alÃ©m do Pandas e usamos o Openpyxl para manipular o arquivo.</h3>

        <div class="code-block">
            <code>from openpyxl import load_workbook
from openpyxl.chart import BarChart, Reference

print("\n--- ETAPA 4: Adicionando grÃ¡fico ao relatÃ³rio ---")

# Carrega o arquivo Excel que acabamos de salvar
wb = load_workbook(arquivo_saida)
# Seleciona a aba onde o grÃ¡fico serÃ¡ inserido
ws = wb['Dashboard Resumo']

# Cria um objeto de grÃ¡fico de barras
chart = BarChart()
chart.title = "Faturamento Mensal"

# Define de onde virÃ£o os dados e as categorias do grÃ¡fico
# (baseado na posiÃ§Ã£o da tabela 'vendas_mensais' que salvamos)
data = Reference(ws, min_col=6, min_row=1, max_row=ws.max_row, max_col=6)
categories = Reference(ws, min_col=5, min_row=2, max_row=ws.max_row)

chart.add_data(data, titles_from_data=True)
chart.set_categories(categories)

# Adiciona o grÃ¡fico na cÃ©lula H2 da planilha
ws.add_chart(chart, "H2")

# Salva o arquivo com o grÃ¡fico incluÃ­do
wb.save(arquivo_saida)

print("âœ… GrÃ¡fico de faturamento mensal adicionado ao dashboard!")</code>
        </div>
    </div>

    <!-- SLIDE 7: CÃ³digo Completo -->
    <div class="slide">
        <h2><span class="emoji">ğŸ”§</span>CÃ³digo Completo do Projeto</h2>
        <h3>Juntando todas as peÃ§as em um Ãºnico script.</h3>

        <div class="code-block" style="font-size: 0.8em; max-height: 450px; overflow-y: auto;">
            <code># Importa as bibliotecas necessÃ¡rias
import pandas as pd
from openpyxl import load_workbook
from openpyxl.chart import BarChart, Reference

# --- ETAPA 1: LEITURA E PREPARAÃ‡ÃƒO DOS DADOS ---
arquivo_entrada = 'dados_vendas.xlsx'
arquivo_saida = 'relatorio_analitico_vendas.xlsx'
df = pd.read_excel(arquivo_entrada)
df['data'] = pd.to_datetime(df['data'])
df['preco_unitario'] = (df['valor'] / df['quantidade']).round(2)
df['mes'] = df['data'].dt.strftime('%Y-%m')

# --- ETAPA 2: ANÃLISE DE NEGÃ“CIO ---
vendas_por_cidade = df.groupby('cidade')['valor'].sum().sort_values(ascending=False).reset_index()
vendas_por_status = df.groupby('status')['valor'].sum().reset_index()
vendas_por_produto = df.groupby('produto').agg(
quantidade_total=('quantidade', 'sum'),
faturamento_total=('valor', 'sum')
).sort_values(by='faturamento_total', ascending=False).reset_index()
vendas_mensais = df.groupby('mes')['valor'].sum().reset_index()

# --- ETAPA 3: GERAÃ‡ÃƒO DO RELATÃ“RIO EM EXCEL ---
with pd.ExcelWriter(arquivo_saida, engine='openpyxl') as writer:
df.to_excel(writer, sheet_name='Dados Consolidados', index=False)
vendas_por_cidade.to_excel(writer, sheet_name='Vendas por Cidade', index=False)
vendas_por_produto.to_excel(writer, sheet_name='Performance dos Produtos', index=False)
vendas_por_status.to_excel(writer, sheet_name='Dashboard Resumo', startrow=0, startcol=0, index=False)
vendas_mensais.to_excel(writer, sheet_name='Dashboard Resumo', startrow=0, startcol=4, index=False)

# --- ETAPA 4: ADICIONANDO GRÃFICO ---
wb = load_workbook(arquivo_saida)
ws = wb['Dashboard Resumo']
chart = BarChart()
chart.title = "Faturamento Mensal"
data = Reference(ws, min_col=6, min_row=1, max_row=len(vendas_mensais)+1, max_col=6)
categories = Reference(ws, min_col=5, min_row=2, max_row=len(vendas_mensais)+1)
chart.add_data(data, titles_from_data=True)
chart.set_categories(categories)
ws.add_chart(chart, "H2")
wb.save(arquivo_saida)

print(f"ğŸš€ PROJETO CONCLUÃDO! O relatÃ³rio '{arquivo_saida}' foi gerado com sucesso!")</code>
        </div>
    </div>

    <!-- SLIDE 8: Resultado e PrÃ³ximos Passos -->
    <div class="slide">
        <h2><span class="emoji">ğŸ†</span>Resultado Final e PrÃ³ximos Passos</h2>
        <h3>O que vocÃª construiu e como ir alÃ©m.</h3>

        <div class="destaque">
            <strong>ğŸ‰ ParabÃ©ns! VocÃª criou um relatÃ³rio automatizado que contÃ©m:</strong>
            <ul style="margin-top: 10px;">
                <li><strong>Aba 1: Dados Consolidados</strong> - Todos os dados originais, limpos e com as colunas novas.</li>
                <li><strong>Aba 2: Vendas por Cidade</strong> - Um ranking das cidades com maior faturamento.</li>
                <li><strong>Aba 3: Performance dos Produtos</strong> - AnÃ¡lise de quais produtos vendem mais e geram mais receita.</li>
                <li><strong>Aba 4: Dashboard Resumo</strong> - Tabelas resumidas e um grÃ¡fico de faturamento mensal.</li>
            </ul>
        </div>

        <div class="exemplo-box">
            <strong>ğŸš€ Como melhorar ainda mais o projeto?</strong>
            <ul style="margin-top: 10px;">
                <li><strong>Adicionar mais grÃ¡ficos:</strong> Crie um grÃ¡fico de pizza para o status das vendas ou um de barras para os produtos.</li>
                <li><strong>FormataÃ§Ã£o Condicional:</strong> Use o `openpyxl` para pintar cÃ©lulas de vermelho se o status for "Cancelada".</li>
                <li><strong>Consolidar vÃ¡rios arquivos:</strong> Modifique o script para ler todos os arquivos de uma pasta (ex: `vendas_jan.xlsx`, `vendas_fev.xlsx`).</li>
                <li><strong>Enviar por E-mail:</strong> Use a biblioteca `smtplib` do Python para enviar o relatÃ³rio final por e-mail automaticamente.</li>
            </ul>
        </div>
    </div>

    <!-- SLIDE 9: ConclusÃ£o -->
    <div class="slide">
        <h2><span class="emoji">ğŸ“</span>ConclusÃ£o do Projeto</h2>

        <div class="destaque">
            <strong>ğŸš€ O que vocÃª aprendeu de mais importante:</strong>
            <ul style="margin-top: 10px;">
                <li>âœ… Ler e manipular arquivos Excel com <strong>Pandas</strong>.</li>
                <li>âœ… Tratar e transformar dados (datas, cÃ¡lculos de novas colunas).</li>
                <li>âœ… Realizar anÃ¡lises de negÃ³cio poderosas com <strong><code>.groupby()</code></strong> e <strong><code>.agg()</code></strong>.</li>
                <li>âœ… Criar relatÃ³rios profissionais com mÃºltiplas abas usando <strong><code>pd.ExcelWriter</code></strong>.</li>
                <li>âœ… Integrar <strong>Pandas</strong> com <strong>Openpyxl</strong> para adicionar funcionalidades nativas do Excel, como grÃ¡ficos.</li>
            </ul>
        </div>

        <div class="exemplo-box" style="text-align: center; padding: 20px;">
             <h2 style="color: #667eea; margin:0;">VocÃª agora tem a base para automatizar qualquer tipo de relatÃ³rio!</h2>
             <p style="font-size: 1.2em; color: #667eea; margin-top: 20px;">
                Continue praticando e explorando! ğŸ
            </p>
        </div>
    </div>

    <!-- Controles de NavegaÃ§Ã£o -->
    <div class="controles">
        <button class="btn btn-voltar-menu" onclick="voltarMenu()">â† Voltar ao Menu</button>
        <button class="btn" onclick="slideAnterior()">â† Anterior</button>
                <span class="contador-slides" id="contador13">1 / 9</span>
        <button class="btn" onclick="proximoSlide()">PrÃ³ximo â†’</button>
    </div>
</div>