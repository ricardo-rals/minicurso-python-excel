        <div id="topico5" class="slides-container">
            <div class="slide active">
                <h2><span class="emoji">üìä</span>T√≥pico 5: Trabalhando com Arquivos Excel</h2>
                <h3>Por que automatizar Excel com Python?</h3>
                <ul>
                    <li><strong>Velocidade:</strong> Processar milhares de linhas em segundos</li>
                    <li><strong>Precis√£o:</strong> Eliminar erros humanos em tarefas repetitivas</li>
                    <li><strong>Produtividade:</strong> Automatizar relat√≥rios e an√°lises</li>
                    <li><strong>Escalabilidade:</strong> Trabalhar com m√∫ltiplos arquivos simultaneamente</li>
                </ul>

                <div class="exemplo-box">
                    <strong>üí° Neste t√≥pico voc√™ vai aprender:</strong>
                    <ul>
                        <li>Criar e manipular planilhas Excel com <strong>Openpyxl</strong></li>
                        <li>Analisar dados com <strong>Pandas</strong></li>
                        <li>Filtrar, ordenar e transformar dados</li>
                        <li>Aplicar formata√ß√£o e estilos</li>
                    </ul>
                </div>

                <div class="destaque">
                    <strong>üì¶ Bibliotecas necess√°rias:</strong>
                    <div class="code-block" style="margin-top: 10px;">
                        <code>pip install openpyxl pandas</code>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìö</span>Biblioteca Openpyxl</h2>
                <h3>O que √© Openpyxl?</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    Openpyxl √© uma biblioteca Python para ler e escrever arquivos Excel (formato .xlsx).
                    Ela permite criar planilhas do zero e aplicar formata√ß√µes como o Excel faz!
                </p>

                <h3>Criando sua primeira planilha:</h3>
                <div class="code-block">
                    <code>from openpyxl import Workbook

# Criar uma nova planilha
wb = Workbook()
ws = wb.active
ws.title = "Vendas"

# Escrever dados nas c√©lulas
ws['A1'] = "Produto"
ws['B1'] = "Quantidade"
ws['C1'] = "Pre√ßo"

ws['A2'] = "Notebook"
ws['B2'] = 5
ws['C2'] = 2500.00

# Salvar a planilha
wb.save("vendas.xlsx")
print("‚úÖ Planilha criada com sucesso!")</code>
                </div>

                <div class="destaque">
                    <strong>üí° Importante:</strong>
                    Openpyxl trabalha com arquivos .xlsx (Excel 2010+). Para arquivos .xls antigos, use a biblioteca xlrd.
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üé®</span>Formata√ß√£o com Openpyxl</h2>
                <h3>Deixando suas planilhas profissionais:</h3>

                <div class="code-block">
                    <code>from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill, Alignment

wb = Workbook()
ws = wb.active

# Escrever cabe√ßalho
ws['A1'] = "Produto"
ws['B1'] = "Quantidade"
ws['C1'] = "Pre√ßo Unit√°rio"

# Formata√ß√£o do cabe√ßalho
header_fill = PatternFill(
    start_color="4472C4",
    end_color="4472C4",
    fill_type="solid"
)
header_font = Font(color="FFFFFF", bold=True, size=12)

for cell in ws[1]:  # Linha 1 (cabe√ßalho)
    cell.fill = header_fill
    cell.font = header_font
    cell.alignment = Alignment(horizontal="center")

# Adicionar dados
produtos = [
    ["Notebook", 5, 2500.00],
    ["Mouse", 20, 45.00],
    ["Teclado", 15, 120.00]
]

for i, produto in enumerate(produtos, start=2):
    ws[f'A{i}'] = produto[0]
    ws[f'B{i}'] = produto[1]
    ws[f'C{i}'] = produto[2]

wb.save("vendas_formatada.xlsx")</code>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìê</span>F√≥rmulas do Excel com Openpyxl</h2>
                <h3>Inserindo f√≥rmulas nas c√©lulas:</h3>

                <div class="code-block">
                    <code>from openpyxl import Workbook

wb = Workbook()
ws = wb.active

# Cabe√ßalhos
ws['A1'] = "Produto"
ws['B1'] = "Quantidade"
ws['C1'] = "Pre√ßo Unit."
ws['D1'] = "Total"

# Dados
ws['A2'] = "Notebook"
ws['B2'] = 5
ws['C2'] = 2500

# F√ìRMULA: Total = Quantidade √ó Pre√ßo
ws['D2'] = "=B2*C2"  # F√≥rmula do Excel!

# Mais produtos
ws['A3'] = "Mouse"
ws['B3'] = 20
ws['C3'] = 45
ws['D3'] = "=B3*C3"

# Soma total de todas as vendas
ws['D5'] = "TOTAL:"
ws['E5'] = "=SUM(D2:D4)"

wb.save("vendas_com_formulas.xlsx")</code>
                </div>

                <div class="exemplo-box">
                    <strong>‚ú® Dica Pro:</strong>
                    As f√≥rmulas s√£o calculadas automaticamente quando voc√™ abre o arquivo no Excel!
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìñ</span>Lendo Planilhas Existentes</h2>
                <h3>Abrindo e lendo dados:</h3>

                <div class="code-block">
                    <code>from openpyxl import load_workbook

# Abrir planilha existente
wb = load_workbook("vendas.xlsx")
ws = wb.active

# Ler uma c√©lula espec√≠fica
print(ws['A1'].value)  # Produto

# Ler uma linha inteira
for cell in ws[2]:  # Linha 2
    print(cell.value)

# Iterar por todas as linhas
for row in ws.iter_rows(min_row=1, max_row=10, values_only=True):
    print(row)

# Exemplo: Ler dados e processar
print("\nüìä PRODUTOS:")
for row in ws.iter_rows(min_row=2, values_only=True):
    produto, qtd, preco = row[0], row[1], row[2]
    total = qtd * preco
    print(f"{produto}: {qtd} un. √ó R$ {preco:.2f} = R$ {total:.2f}")</code>
                </div>

                <div class="destaque">
                    <strong>‚ö†Ô∏è Aten√ß√£o:</strong>
                    Use <code>values_only=True</code> para obter apenas os valores, sem objetos de c√©lula.
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üêº</span>Biblioteca Pandas</h2>
                <h3>O poder da an√°lise de dados!</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    Pandas √© a biblioteca mais popular para an√°lise de dados em Python.
                    Ela trabalha com <strong>DataFrames</strong>, que s√£o como tabelas Excel turbinadas!
                </p>

                <h3>Lendo Excel com Pandas:</h3>
                <div class="code-block">
                    <code>import pandas as pd

# Ler planilha Excel
df = pd.read_excel("vendas.xlsx")

# Exibir os dados
print(df)

# Sa√≠da:
#     Produto  Quantidade  Pre√ßo
# 0  Notebook           5  2500.0
# 1     Mouse          20    45.0
# 2   Teclado          15   120.0

# Informa√ß√µes b√°sicas
print(df.info())
print(df.describe())  # Estat√≠sticas descritivas</code>
                </div>

                <div class="exemplo-box">
                    <strong>üí° Vantagem do Pandas:</strong>
                    Opera√ß√µes complexas em poucas linhas de c√≥digo!
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üîç</span>Opera√ß√µes B√°sicas com Pandas</h2>

                <div class="code-block">
                    <code>import pandas as pd

df = pd.read_excel("vendas.xlsx")

# 1. Adicionar nova coluna calculada
df['Total'] = df['Quantidade'] * df['Pre√ßo']

# 2. Filtrar dados
produtos_caros = df[df['Pre√ßo'] > 100]
print("Produtos acima de R$ 100:")
print(produtos_caros)

# 3. Ordenar dados
df_ordenado = df.sort_values('Total', ascending=False)
print("\nProdutos por total de vendas:")
print(df_ordenado)

# 4. Estat√≠sticas
print(f"\nüìä ESTAT√çSTICAS:")
print(f"Total geral: R$ {df['Total'].sum():.2f}")
print(f"M√©dia de pre√ßo: R$ {df['Pre√ßo'].mean():.2f}")
print(f"Produto mais vendido: {df.loc[df['Quantidade'].idxmax(), 'Produto']}")

# 5. Salvar resultado
df.to_excel("vendas_analisadas.xlsx", index=False)
print("\n‚úÖ An√°lise salva!")</code>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üéØ</span>Filtragem Avan√ßada com Pandas</h2>

                <div class="code-block">
                    <code>import pandas as pd

df = pd.read_excel("vendas.xlsx")
df['Total'] = df['Quantidade'] * df['Pre√ßo']

# Filtros condicionais
# 1. Filtro simples
alta_quantidade = df[df['Quantidade'] > 10]

# 2. Filtros m√∫ltiplos (AND)
produtos_especiais = df[
    (df['Quantidade'] > 10) &
    (df['Pre√ßo'] > 100)
]

# 3. Filtros m√∫ltiplos (OR)
produtos_destaque = df[
    (df['Quantidade'] > 15) |
    (df['Pre√ßo'] > 1000)
]

# 4. Filtrar por lista de valores
produtos_selecionados = df[
    df['Produto'].isin(['Notebook', 'Monitor'])
]

# 5. Filtrar valores nulos
df_limpo = df[df['Pre√ßo'].notna()]

# 6. Buscar por texto
produtos_com_o = df[
    df['Produto'].str.contains('o', case=False)
]

print("Produtos que cont√™m 'o':")
print(produtos_com_o)</code>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìä</span>Agrupamento e Agrega√ß√£o</h2>

                <div class="code-block">
                    <code>import pandas as pd

# Exemplo com dados de vendas por regi√£o
dados = {
    'Regi√£o': ['Norte', 'Sul', 'Norte', 'Sul', 'Norte'],
    'Produto': ['Mouse', 'Teclado', 'Monitor', 'Mouse', 'Teclado'],
    'Vendas': [100, 150, 200, 120, 180],
    'Quantidade': [10, 15, 5, 12, 18]
}

df = pd.DataFrame(dados)

# 1. Agrupar por regi√£o
vendas_por_regiao = df.groupby('Regi√£o')['Vendas'].sum()
print("Vendas por regi√£o:")
print(vendas_por_regiao)

# 2. M√∫ltiplas agrega√ß√µes
resumo = df.groupby('Regi√£o').agg({
    'Vendas': ['sum', 'mean', 'count'],
    'Quantidade': ['sum', 'mean']
})
print("\nResumo completo:")
print(resumo)

# 3. Criar tabela din√¢mica
pivot = pd.pivot_table(
    df,
    values='Vendas',
    index='Regi√£o',
    columns='Produto',
    aggfunc='sum',
    fill_value=0
)
print("\nTabela Din√¢mica:")
print(pivot)</code>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üîÑ</span>Transforma√ß√£o de Dados</h2>

                <div class="code-block">
                    <code>import pandas as pd

df = pd.read_excel("vendas.xlsx")

# 1. Aplicar fun√ß√£o a uma coluna
df['Pre√ßo_com_desconto'] = df['Pre√ßo'].apply(lambda x: x * 0.9)

# 2. Categorizar valores
def categorizar_preco(preco):
    if preco > 500:
        return 'Premium'
    elif preco > 100:
        return 'Standard'
    else:
        return 'B√°sico'

df['Categoria'] = df['Pre√ßo'].apply(categorizar_preco)

# 3. Criar colunas condicionais
df['Status_Estoque'] = df['Quantidade'].apply(
    lambda x: 'Baixo' if x < 10 else 'M√©dio' if x < 20 else 'Alto'
)

# 4. Renomear colunas
df = df.rename(columns={
    'Quantidade': 'Qtd',
    'Pre√ßo': 'Valor_Unit'
})

# 5. Remover colunas
df = df.drop(['Categoria'], axis=1)

# 6. Ordenar colunas
df = df[['Produto', 'Qtd', 'Valor_Unit', 'Status_Estoque']]

print(df)</code>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üíæ</span>Salvando Dados em Excel</h2>

                <div class="code-block">
                    <code>import pandas as pd

df = pd.read_excel("vendas.xlsx")

# 1. Salvar DataFrame simples
df.to_excel("saida.xlsx", index=False)

# 2. Salvar m√∫ltiplas abas
with pd.ExcelWriter("relatorio_completo.xlsx") as writer:
    df.to_excel(writer, sheet_name="Vendas", index=False)

    # Criar resumo
    resumo = df.groupby('Produto')['Quantidade'].sum()
    resumo.to_excel(writer, sheet_name="Resumo")

    # Criar an√°lise
    df_analise = df[df['Quantidade'] > 10]
    df_analise.to_excel(writer, sheet_name="Alta_Venda", index=False)

print("‚úÖ Relat√≥rio com m√∫ltiplas abas criado!")

# 3. Salvar com formata√ß√£o (usando openpyxl)
from openpyxl import load_workbook
from openpyxl.styles import Font

df.to_excel("formatado.xlsx", index=False)

# Abrir e formatar
wb = load_workbook("formatado.xlsx")
ws = wb.active

# Formatar cabe√ßalho
for cell in ws[1]:
    cell.font = Font(bold=True, size=12)

wb.save("formatado.xlsx")</code>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">‚úèÔ∏è</span>Exerc√≠cio Pr√°tico - Excel com Python</h2>

                <div class="exemplo-box">
                    <strong>üéØ Desafio: Sistema de Gest√£o de Produtos</strong>
                    <p>Crie um sistema que:</p>
                    <ol>
                        <li>Leia uma planilha de produtos</li>
                        <li>Calcule o valor total de estoque</li>
                        <li>Identifique produtos com estoque baixo (< 10)</li>
                        <li>Aplique 10% de desconto em produtos acima de R$ 500</li>
                        <li>Gere um relat√≥rio formatado com os resultados</li>
                    </ol>
                    <details>
                        <summary>Ver solu√ß√£o</summary>
                        <div class="code-block" style="margin-top: 10px;">
                            <code>import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import Font, PatternFill

# 1. Ler planilha
df = pd.read_excel("produtos.xlsx")

# 2. Calcular valor total
df['Total_Estoque'] = df['Quantidade'] * df['Pre√ßo']

# 3. Identificar estoque baixo
df['Alerta'] = df['Quantidade'].apply(
    lambda x: '‚ö†Ô∏è BAIXO' if x < 10 else '‚úÖ OK'
)

# 4. Aplicar desconto
df['Pre√ßo_Final'] = df['Pre√ßo'].apply(
    lambda x: x * 0.9 if x > 500 else x
)

# 5. Gerar relat√≥rio
df.to_excel("relatorio_produtos.xlsx", index=False)

# Formatar
wb = load_workbook("relatorio_produtos.xlsx")
ws = wb.active

for cell in ws[1]:
    cell.font = Font(bold=True, color="FFFFFF")
    cell.fill = PatternFill(start_color="4472C4",
                           end_color="4472C4",
                           fill_type="solid")

wb.save("relatorio_produtos.xlsx")
print("‚úÖ Relat√≥rio gerado com sucesso!")</code>
                        </div>
                    </details>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üéì</span>Resumo - T√≥pico 5</h2>

                <div class="destaque">
                    <strong>üìö O que aprendemos:</strong>
                    <ul style="margin-top: 10px;">
                        <li>‚úÖ Criar planilhas com <strong>Openpyxl</strong></li>
                        <li>‚úÖ Aplicar formata√ß√£o e estilos profissionais</li>
                        <li>‚úÖ Inserir f√≥rmulas do Excel</li>
                        <li>‚úÖ Ler e processar dados com <strong>Pandas</strong></li>
                        <li>‚úÖ Filtrar, ordenar e transformar dados</li>
                        <li>‚úÖ Agrupar e agregar informa√ß√µes</li>
                        <li>‚úÖ Salvar m√∫ltiplas abas e relat√≥rios</li>
                    </ul>
                </div>

                <div class="exemplo-box">
                    <strong>üöÄ Pr√≥ximo passo:</strong>
                    No T√≥pico 6, vamos aprender a criar gr√°ficos incr√≠veis com Matplotlib
                    para visualizar nossos dados do Excel!
                </div>

                <div class="code-block">
                    <code># Exemplo completo resumido
import pandas as pd

# Ler
df = pd.read_excel("dados.xlsx")

# Analisar
df['Total'] = df['Qtd'] * df['Pre√ßo']
resumo = df.groupby('Categoria')['Total'].sum()

# Salvar
df.to_excel("resultado.xlsx", index=False)
print("‚úÖ Pronto!")</code>
                </div>
            </div>

            <div class="controles">
                <button class="btn btn-voltar-menu" onclick="voltarMenu()">‚Üê Voltar ao Menu</button>
                <button class="btn" onclick="slideAnterior()">‚Üê Anterior</button>
                <span class="contador-slides" id="contador5">1 / 13</span>
                <button class="btn" onclick="proximoSlide()">Pr√≥ximo ‚Üí</button>
            </div>
        </div>
