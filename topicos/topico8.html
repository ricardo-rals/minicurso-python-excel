        <div id="topico8" class="slides-container">
            <div class="slide active">
                <h2><span class="emoji">üìÅ</span>T√≥pico 8: Manipula√ß√£o de Arquivos</h2>
                <h3>Por que trabalhar com arquivos?</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    Na pr√°tica, voc√™ frequentemente precisa ler dados de arquivos, processar informa√ß√µes
                    e salvar resultados. Python torna isso simples e eficiente!
                </p>

                <ul>
                    <li><strong>üìÑ Arquivos de texto (.txt):</strong> Logs, dados simples, configura√ß√µes</li>
                    <li><strong>üìä Arquivos CSV (.csv):</strong> Dados tabulares, planilhas simples</li>
                    <li><strong>üíæ Persist√™ncia:</strong> Salvar dados para usar depois</li>
                    <li><strong>üîÑ Integra√ß√£o:</strong> Trocar dados com outros programas</li>
                </ul>

                <div class="exemplo-box">
                    <strong>üí° Neste t√≥pico voc√™ vai aprender:</strong>
                    <ul>
                        <li>Ler arquivos de texto (.txt)</li>
                        <li>Escrever em arquivos de texto</li>
                        <li>Trabalhar com arquivos CSV</li>
                        <li>Usar o m√≥dulo <code>csv</code> do Python</li>
                        <li>Integrar CSV com Pandas</li>
                    </ul>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üîì</span>Modos de Acesso de Arquivo</h2>
                <h3>Entendendo os par√¢metros do open()</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    Quando voc√™ usa <code>open('arquivo.txt', 'r', encoding='utf-8')</code>, o segundo par√¢metro
                    define <strong>como</strong> voc√™ vai trabalhar com o arquivo. Vamos entender cada modo:
                </p>
                
                <div class="slide-content">
                    <div class="destaque" style="margin: 20px 0;">
                        <strong>üìå Modos de Abertura de Arquivo:</strong>
                        <ul style="margin-top: 15px;">
                            <li><strong><code>'r'</code> - Read (Ler):</strong> Abre o arquivo apenas para leitura. 
                                <span style="color: #d32f2f;">‚ö†Ô∏è Erro se o arquivo n√£o existir!</span></li>
                            <li><strong><code>'w'</code> - Write (Escrever):</strong> Abre para escrita. 
                                <span style="color: #d32f2f;">‚ö†Ô∏è Sobrescreve o arquivo se ele j√° existir!</span></li>
                            <li><strong><code>'a'</code> - Append (Anexar):</strong> Abre para escrita, mas adiciona ao final do arquivo. 
                                Cria o arquivo se n√£o existir.</li>
                            <li><strong><code>'x'</code> - Exclusive (Exclusivo):</strong> Cria um novo arquivo. 
                                <span style="color: #d32f2f;">‚ö†Ô∏è Erro se o arquivo j√° existir!</span></li>
                            <li><strong><code>'r+'</code> - Read and Write:</strong> Abre para leitura e escrita simultaneamente.</li>
                        </ul>
                    </div>

                    <h3>Exemplo pr√°tico:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code"># Modo 'r' - Ler (read)
with open('dados.txt', 'r', encoding='utf-8') as arquivo:
    conteudo = arquivo.read()
    # arquivo.write("teste")  # ‚ùå ERRO! Modo 'r' n√£o permite escrita

# Modo 'w' - Escrever (write) - SOBRESCREVE se existir!
with open('saida.txt', 'w', encoding='utf-8') as arquivo:
    arquivo.write("Novo conte√∫do")
    # arquivo.read()  # ‚ùå ERRO! Modo 'w' n√£o permite leitura

# Modo 'a' - Anexar (append) - ADICIONA ao final
with open('log.txt', 'a', encoding='utf-8') as arquivo:
    arquivo.write("Nova linha no final\n")

# Modo 'x' - Exclusive (exclusivo) - CRIA novo arquivo
try:
    with open('novo.txt', 'x', encoding='utf-8') as arquivo:
        arquivo.write("Arquivo criado com sucesso!\n")
    print("‚úÖ Arquivo criado!")
except FileExistsError:
    print("‚ùå Arquivo j√° existe! Use 'w' para sobrescrever.")

# Modo 'r+' - Read and Write (ler e escrever)
with open('dados.txt', 'r+', encoding='utf-8') as arquivo:
    conteudo = arquivo.read()  # Pode ler
    arquivo.write("\nLinha adicionada no final")  # Pode escrever
    # Cuidado: escreve a partir da posi√ß√£o atual do cursor!

# encoding='utf-8' √© importante para caracteres especiais (acentos, etc.)</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">‚úÖ Arquivo criado!</div>
                    </div>

                    <div class="exemplo-box" style="margin-top: 20px;">
                        <strong>üí° Dica Importante:</strong>
                        <p style="margin: 10px 0;">
                            Sempre use <code>encoding='utf-8'</code> ao trabalhar com arquivos de texto em portugu√™s.
                            Isso garante que acentos e caracteres especiais sejam salvos e lidos corretamente!
                        </p>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìñ</span>Ler Arquivos de Texto</h2>
                <h3>Usando open() e with statement</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    O <code>with</code> statement garante que o arquivo seja fechado automaticamente,
                    mesmo se ocorrer um erro. √â a forma recomendada!
                </p>
                
                <div class="slide-content">
                    <h3>Ler arquivo completo com read():</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code"># Forma recomendada: usar 'with'
with open('dados.txt', 'r', encoding='utf-8') as arquivo:
    conteudo = arquivo.read()
    print(conteudo)

# O arquivo √© fechado automaticamente ao sair do bloco 'with'</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">Ol√°, mundo!
Esta √© a primeira linha.
Esta √© a segunda linha.</div>
                    </div>

                    <h3>Ler linha por linha com readline():</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code"># Ler apenas a primeira linha
with open('dados.txt', 'r', encoding='utf-8') as arquivo:
    primeira_linha = arquivo.readline()
    print(f"Primeira linha: {primeira_linha.strip()}")  # strip() remove \n
    
    segunda_linha = arquivo.readline()
    print(f"Segunda linha: {segunda_linha.strip()}")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">Primeira linha: Ol√°, mundo!
Segunda linha: Esta √© a primeira linha.</div>
                    </div>

                    <h3>Ler todas as linhas com readlines():</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code"># Ler todas as linhas em uma lista
with open('dados.txt', 'r', encoding='utf-8') as arquivo:
    linhas = arquivo.readlines()
    print(f"Total de linhas: {len(linhas)}")
    
    for i, linha in enumerate(linhas, 1):
        print(f"Linha {i}: {linha.strip()}")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">Total de linhas: 3
Linha 1: Ol√°, mundo!
Linha 2: Esta √© a primeira linha.
Linha 3: Esta √© a segunda linha.</div>
                </div>

                    <h3>Iterar diretamente sobre o arquivo (mais eficiente):</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code"># Iterar sobre o arquivo (recomendado para arquivos grandes)
with open('dados.txt', 'r', encoding='utf-8') as arquivo:
    for linha in arquivo:
        print(f"Linha: {linha.strip()}")

# Mais eficiente em mem√≥ria do que readlines() para arquivos grandes!</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">Linha: Ol√°, mundo!
Linha: Esta √© a primeira linha.
Linha: Esta √© a segunda linha.</div>
                    </div>

                    <div class="destaque" style="margin-top: 20px;">
                        <strong>üìå Modos de abertura de arquivo:</strong>
                        <ul>
                            <li><code>'r'</code> - Ler (read) - padr√£o</li>
                            <li><code>'w'</code> - Escrever (write) - sobrescreve se existir</li>
                            <li><code>'a'</code> - Anexar (append) - adiciona ao final</li>
                            <li><code>'x'</code> - Criar - falha se arquivo j√° existe</li>
                            <li><code>encoding='utf-8'</code> - Especificar codifica√ß√£o (importante para caracteres especiais!)</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">‚úèÔ∏è</span>Escrever em Arquivos de Texto</h2>
                <h3>Criando e salvando dados em arquivos</h3>
                
                <div class="slide-content">
                    <h3>Escrever em arquivo com write():</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code"># Escrever conte√∫do em arquivo (modo 'w' sobrescreve)
with open('saida.txt', 'w', encoding='utf-8') as arquivo:
    arquivo.write("Primeira linha\n")
    arquivo.write("Segunda linha\n")
    arquivo.write("Terceira linha\n")

print("‚úÖ Arquivo criado com sucesso!")

# Verificar conte√∫do
with open('saida.txt', 'r', encoding='utf-8') as arquivo:
    print(arquivo.read())</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">‚úÖ Arquivo criado com sucesso!
Primeira linha
Segunda linha
Terceira linha</div>
                    </div>

                    <h3>Anexar ao arquivo (append):</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code"># Anexar ao final do arquivo (modo 'a')
with open('saida.txt', 'a', encoding='utf-8') as arquivo:
    arquivo.write("Quarta linha (anexada)\n")
    arquivo.write("Quinta linha (anexada)\n")

# Ler arquivo completo
with open('saida.txt', 'r', encoding='utf-8') as arquivo:
    print(arquivo.read())</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">Primeira linha
Segunda linha
Terceira linha
Quarta linha (anexada)
Quinta linha (anexada)</div>
                    </div>

                    <h3>Escrever m√∫ltiplas linhas com writelines():</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code"># Escrever lista de linhas
linhas = [
    "Linha 1\n",
    "Linha 2\n",
    "Linha 3\n"
]

with open('saida2.txt', 'w', encoding='utf-8') as arquivo:
    arquivo.writelines(linhas)

# Usando join() para criar texto com quebras de linha
texto = "\n".join(["A", "B", "C"])
with open('saida3.txt', 'w', encoding='utf-8') as arquivo:
    arquivo.write(texto)</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print"></div>
                </div>

                    <div class="destaque" style="margin-top: 20px;">
                        <strong>‚ö†Ô∏è Aten√ß√£o:</strong>
                        <ul>
                            <li>Modo <code>'w'</code> <strong>sobrescreve</strong> o arquivo se ele j√° existe!</li>
                            <li>Modo <code>'a'</code> <strong>adiciona</strong> ao final do arquivo</li>
                            <li>Sempre use <code>encoding='utf-8'</code> para suportar caracteres especiais (acentos, etc.)</li>
                            <li><code>\n</code> representa quebra de linha</li>
                    </ul>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üí°</span>Exemplo Pr√°tico: Processar Log</h2>
                <h3>Ler e analisar arquivo de log</h3>
                
                <div class="slide-content">
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code"># Exemplo: Contar linhas e palavras em arquivo de log
arquivo_log = 'log.txt'

with open(arquivo_log, 'r', encoding='utf-8') as arquivo:
    linhas = arquivo.readlines()
    total_linhas = len(linhas)
    
    total_palavras = 0
    for linha in linhas:
        palavras = linha.split()
        total_palavras += len(palavras)

print(f"üìä ESTAT√çSTICAS DO LOG:")
print(f"Total de linhas: {total_linhas}")
print(f"Total de palavras: {total_palavras}")

# Filtrar linhas que cont√™m "ERRO"
print("\n‚ö†Ô∏è LINHAS COM ERRO:")
with open(arquivo_log, 'r', encoding='utf-8') as arquivo:
    for i, linha in enumerate(arquivo, 1):
        if 'ERRO' in linha.upper():
            print(f"Linha {i}: {linha.strip()}")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">üìä ESTAT√çSTICAS DO LOG:
Total de linhas: 10
Total de palavras: 45

‚ö†Ô∏è LINHAS COM ERRO:
Linha 5: ERRO: Arquivo n√£o encontrado
Linha 8: ERRO: Timeout na conex√£o</div>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìä</span>Arquivos CSV - Introdu√ß√£o</h2>
                <h3>Comma-Separated Values (Valores Separados por V√≠rgula)</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    CSV √© um formato simples para dados tabulares. Cada linha √© um registro,
                    e os campos s√£o separados por v√≠rgulas (ou outros delimitadores).
                </p>
                
                <div class="slide-content">
                    <h3>Exemplo de arquivo CSV:</h3>
                    <div class="code-block">
                        <code># dados.csv
Nome,Idade,Cidade
Jo√£o,25,S√£o Paulo
Maria,30,Rio de Janeiro
Pedro,28,Belo Horizonte</code>
                    </div>

                    <h3>Por que usar CSV?</h3>
                    <ul>
                        <li>Formato universal - funciona em Excel, Google Sheets, etc.</li>
                        <li>F√°cil de ler e escrever</li>
                        <li>Leve e r√°pido para processar</li>
                        <li>Ideal para dados tabulares simples</li>
                    </ul>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìñ</span>Ler CSV com M√≥dulo csv</h2>
                <h3>Usando csv.reader()</h3>
                
                <div class="slide-content">
                    <h3>Ler CSV b√°sico:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import csv

# Ler CSV com csv.reader()
with open('dados.csv', 'r', encoding='utf-8') as arquivo:
    leitor = csv.reader(arquivo)
    
    # Pular cabe√ßalho (primeira linha)
    cabecalho = next(leitor)
    print(f"Cabe√ßalho: {cabecalho}")
    
    # Ler dados
    print("\nDados:")
    for linha in leitor:
        print(linha)  # Cada linha √© uma lista de strings</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">Cabe√ßalho: ['Nome', 'Idade', 'Cidade']
Dados:
['Jo√£o', '25', 'S√£o Paulo']
['Maria', '30', 'Rio de Janeiro']
['Pedro', '28', 'Belo Horizonte']</div>
            </div>

                    <h3>Processar dados CSV:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import csv

# Ler e processar dados
pessoas = []
with open('dados.csv', 'r', encoding='utf-8') as arquivo:
    leitor = csv.reader(arquivo)
    cabecalho = next(leitor)  # Pula cabe√ßalho
    
    for linha in leitor:
        pessoa = {
            'nome': linha[0],
            'idade': int(linha[1]),  # Converter para int
            'cidade': linha[2]
        }
        pessoas.append(pessoa)

print("üìã LISTA DE PESSOAS:")
for pessoa in pessoas:
    print(f"{pessoa['nome']}, {pessoa['idade']} anos, de {pessoa['cidade']}")

# Calcular m√©dia de idade
idades = [p['idade'] for p in pessoas]
media_idade = sum(idades) / len(idades)
print(f"\nM√©dia de idade: {media_idade:.1f} anos")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">üìã LISTA DE PESSOAS:
Jo√£o, 25 anos, de S√£o Paulo
Maria, 30 anos, de Rio de Janeiro
Pedro, 28 anos, de Belo Horizonte

M√©dia de idade: 27.7 anos</div>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìù</span>Ler CSV com csv.DictReader()</h2>
                <h3>Mais conveniente: acesso por nome de coluna</h3>
                
                <div class="slide-content">
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import csv

# DictReader usa a primeira linha como chaves do dicion√°rio
with open('dados.csv', 'r', encoding='utf-8') as arquivo:
    leitor = csv.DictReader(arquivo)
    
    print("üìã DADOS COM ACESSO POR NOME:")
    for linha in leitor:
        # Acesso por nome de coluna (mais leg√≠vel!)
        print(f"{linha['Nome']}, {linha['Idade']} anos, de {linha['Cidade']}")
        # linha √© um dicion√°rio: {'Nome': 'Jo√£o', 'Idade': '25', 'Cidade': 'S√£o Paulo'}</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">üìã DADOS COM ACESSO POR NOME:
Jo√£o, 25 anos, de S√£o Paulo
Maria, 30 anos, de Rio de Janeiro
Pedro, 28 anos, de Belo Horizonte</div>
            </div>

                    <h3>Exemplo pr√°tico completo:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import csv

# Processar dados de vendas CSV
vendas_total = 0
vendedores = []

with open('vendas.csv', 'r', encoding='utf-8') as arquivo:
    leitor = csv.DictReader(arquivo)
    
    for registro in leitor:
        vendedor = registro['Vendedor']
        valor = float(registro['Valor'])
        
        vendas_total += valor
        vendedores.append({
            'nome': vendedor,
            'valor': valor
        })

print(f"üí∞ TOTAL DE VENDAS: R$ {vendas_total:.2f}")
print(f"üìä VENDEDORES:")
for v in vendedores:
    print(f"  - {v['nome']}: R$ {v['valor']:.2f}")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">üí∞ TOTAL DE VENDAS: R$ 1500.00
üìä VENDEDORES:
  - Jo√£o: R$ 500.00
  - Maria: R$ 700.00
  - Pedro: R$ 300.00</div>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">‚úèÔ∏è</span>Escrever CSV com csv.writer()</h2>
                <h3>Criando arquivos CSV</h3>
                
                <div class="slide-content">
                    <h3>Escrever CSV b√°sico:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import csv

# Dados para escrever
dados = [
    ['Nome', 'Idade', 'Cidade'],  # Cabe√ßalho
    ['Jo√£o', 25, 'S√£o Paulo'],
    ['Maria', 30, 'Rio de Janeiro'],
    ['Pedro', 28, 'Belo Horizonte']
]

# Escrever CSV
with open('saida.csv', 'w', newline='', encoding='utf-8') as arquivo:
    escritor = csv.writer(arquivo)
    escritor.writerows(dados)

print("‚úÖ CSV criado com sucesso!")

# newline='' √© importante para evitar linhas vazias extras!</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">‚úÖ CSV criado com sucesso!</div>
                    </div>

                    <h3>Escrever CSV com csv.DictWriter():</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import csv

# Dados como lista de dicion√°rios
pessoas = [
    {'Nome': 'Jo√£o', 'Idade': 25, 'Cidade': 'S√£o Paulo'},
    {'Nome': 'Maria', 'Idade': 30, 'Cidade': 'Rio de Janeiro'},
    {'Nome': 'Pedro', 'Idade': 28, 'Cidade': 'Belo Horizonte'}
]

# Escrever CSV com DictWriter
with open('saida2.csv', 'w', newline='', encoding='utf-8') as arquivo:
    campos = ['Nome', 'Idade', 'Cidade']
    escritor = csv.DictWriter(arquivo, fieldnames=campos)
    
    escritor.writeheader()  # Escreve cabe√ßalho
    escritor.writerows(pessoas)  # Escreve todos os dados

print("‚úÖ CSV criado com DictWriter!")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">‚úÖ CSV criado com DictWriter!</div>
                    </div>

                    <h3>Exemplo pr√°tico: Exportar dados para CSV:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import csv

# Dados em mem√≥ria
produtos = [
    {'Produto': 'Notebook', 'Pre√ßo': 2500.00, 'Estoque': 10},
    {'Produto': 'Mouse', 'Pre√ßo': 50.00, 'Estoque': 50},
    {'Produto': 'Teclado', 'Pre√ßo': 120.00, 'Estoque': 30}
]

# Exportar para CSV
with open('produtos.csv', 'w', newline='', encoding='utf-8') as arquivo:
    campos = ['Produto', 'Pre√ßo', 'Estoque']
    escritor = csv.DictWriter(arquivo, fieldnames=campos)
    
    escritor.writeheader()
    for produto in produtos:
        escritor.writerow(produto)

print("‚úÖ Produtos exportados para produtos.csv!")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">‚úÖ Produtos exportados para produtos.csv!</div>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üêº</span>CSV com Pandas</h2>
                <h3>A forma mais f√°cil de trabalhar com CSV!</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    Pandas torna o trabalho com CSV muito mais simples e poderoso!
                </p>
                
                <div class="slide-content">
                    <h3>Ler CSV com pd.read_csv():</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import pandas as pd

# Ler CSV em um DataFrame (muito f√°cil!)
df = pd.read_csv('dados.csv', encoding='utf-8')

print("üìä DADOS DO CSV:")
print(df)

# Acesso por coluna
print(f"\nNomes: {df['Nome'].tolist()}")
print(f"M√©dia de idade: {df['Idade'].mean():.1f}")

# Filtrar dados
sp = df[df['Cidade'] == 'S√£o Paulo']
print(f"\nPessoas de SP:\n{sp}")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">üìä DADOS DO CSV:
   Nome  Idade          Cidade
0  Jo√£o     25     S√£o Paulo
1  Maria    30  Rio de Janeiro
2  Pedro    28  Belo Horizonte

Nomes: ['Jo√£o', 'Maria', 'Pedro']
M√©dia de idade: 27.7

Pessoas de SP:
  Nome  Idade     Cidade
0  Jo√£o     25  S√£o Paulo</div>
                </div>

                    <h3>Salvar DataFrame em CSV:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import pandas as pd

# Criar DataFrame
df = pd.DataFrame({
    'Produto': ['Notebook', 'Mouse', 'Teclado'],
    'Pre√ßo': [2500.00, 50.00, 120.00],
    'Estoque': [10, 50, 30]
})

# Calcular total em estoque
df['Total'] = df['Pre√ßo'] * df['Estoque']

# Salvar em CSV
df.to_csv('produtos_analisados.csv', index=False, encoding='utf-8')

print("‚úÖ CSV salvo com sucesso!")
print(f"\nTotal em estoque: R$ {df['Total'].sum():.2f}")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">‚úÖ CSV salvo com sucesso!

Total em estoque: R$ 30100.00</div>
                    </div>

                    <div class="destaque" style="margin-top: 20px;">
                        <strong>üí° Vantagens do Pandas para CSV:</strong>
                        <ul>
                            <li><strong>Simplicidade:</strong> Uma linha para ler/escrever</li>
                            <li><strong>Funcionalidades:</strong> Filtros, agrupamentos, c√°lculos</li>
                            <li><strong>Performance:</strong> Otimizado para grandes volumes</li>
                            <li><strong>Convers√£o:</strong> F√°cil converter para Excel depois</li>
                    </ul>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üîÑ</span>Converter CSV para Excel</h2>
                <h3>Integrando CSV e Excel</h3>
                
                <div class="slide-content">
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import pandas as pd

# Ler CSV
df = pd.read_csv('dados.csv', encoding='utf-8')

# Processar dados (exemplo: adicionar coluna calculada)
df['Idade_em_2050'] = df['Idade'] + (2050 - 2025)

# Salvar em Excel
df.to_excel('dados.xlsx', index=False)

print("‚úÖ CSV convertido para Excel com sucesso!")
print("\nDataFrame processado:")
print(df)</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">‚úÖ CSV convertido para Excel com sucesso!

DataFrame processado:
   Nome  Idade          Cidade  Idade_em_2050
0  Jo√£o     25     S√£o Paulo              50
1  Maria    30  Rio de Janeiro              55
2  Pedro    28  Belo Horizonte              53</div>
                </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìÇ</span>Trabalhando com Diret√≥rios e Caminhos</h2>
                <h3>Organizando arquivos e navegando pelo sistema</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    O m√≥dulo <code>os</code> oferece fun√ß√µes para trabalhar com diret√≥rios, verificar exist√™ncia
                    de arquivos e construir caminhos de forma segura.
                </p>
                
                <div class="slide-content">
                    <h3>Verificar exist√™ncia de arquivos e diret√≥rios:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import os

# Verificar se arquivo existe
arquivo = "dados.txt"
if os.path.exists(arquivo):
    print(f"‚úÖ Arquivo '{arquivo}' existe!")
else:
    print(f"‚ùå Arquivo '{arquivo}' n√£o encontrado.")

# Verificar se √© arquivo ou diret√≥rio
caminho = "pastas"
if os.path.isfile(caminho):
    print(f"{caminho} √© um arquivo")
elif os.path.isdir(caminho):
    print(f"{caminho} √© um diret√≥rio")
else:
    print(f"{caminho} n√£o existe")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">‚úÖ Arquivo 'dados.txt' existe!
pastas √© um diret√≥rio</div>
                    </div>

                    <h3>Construir caminhos de forma segura:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import os

# ‚ùå RUIM - concatenar strings (n√£o funciona bem em diferentes sistemas)
caminho_ruim = "pasta" + "/" + "subpasta" + "/" + "arquivo.txt"

# ‚úÖ BOM - usar os.path.join() (funciona em Windows, Linux, Mac)
pasta = "pasta"
subpasta = "subpasta"
arquivo = "arquivo.txt"
caminho_bom = os.path.join(pasta, subpasta, arquivo)
print(f"Caminho: {caminho_bom}")

# Exemplo pr√°tico
base_dir = "dados"
ano = "2025"
mes = "01"
arquivo_vendas = os.path.join(base_dir, ano, mes, "vendas.csv")
print(f"Arquivo de vendas: {arquivo_vendas}")

# Outras fun√ß√µes √∫teis
print(f"Nome do arquivo: {os.path.basename(caminho_bom)}")
print(f"Diret√≥rio: {os.path.dirname(caminho_bom)}")
print(f"Extens√£o: {os.path.splitext(arquivo)[1]}")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">Caminho: pasta/subpasta/arquivo.txt
Arquivo de vendas: dados/2025/01/vendas.csv
Nome do arquivo: arquivo.txt
Diret√≥rio: pasta/subpasta
Extens√£o: .txt</div>
                    </div>

                    <h3>Navegar e listar diret√≥rios:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import os

# Obter diret√≥rio atual
diretorio_atual = os.getcwd()
print(f"Diret√≥rio atual: {diretorio_atual}")

# Listar arquivos e pastas no diret√≥rio
print("\nüìÅ Conte√∫do do diret√≥rio atual:")
for item in os.listdir('.'):
    caminho_completo = os.path.join('.', item)
    if os.path.isfile(caminho_completo):
        tipo = "üìÑ ARQUIVO"
    elif os.path.isdir(caminho_completo):
        tipo = "üìÇ PASTA"
    else:
        tipo = "‚ùì OUTRO"
    
    tamanho = os.path.getsize(caminho_completo) if os.path.isfile(caminho_completo) else 0
    print(f"{tipo}: {item} ({tamanho} bytes)")

# Listar apenas arquivos .csv
print("\nüìä Arquivos CSV:")
for arquivo in os.listdir('.'):
    if arquivo.endswith('.csv'):
        print(f"  - {arquivo}")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">Diret√≥rio atual: C:\Users\ricar\Documents\minicurso-python-excel

üìÅ Conte√∫do do diret√≥rio atual:
üìÑ ARQUIVO: dados.txt (1024 bytes)
üìÇ PASTA: topicos
üìÑ ARQUIVO: index.html (8192 bytes)
üìÑ ARQUIVO: vendas.csv (512 bytes)

üìä Arquivos CSV:
  - vendas.csv</div>
                </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üóÇÔ∏è</span>Criar e Manipular Diret√≥rios</h2>
                <h3>Organizando seus arquivos programaticamente</h3>
                
                <div class="slide-content">
                    <h3>Criar diret√≥rios:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import os

# Criar um diret√≥rio
os.mkdir("nova_pasta")
print("‚úÖ Pasta criada!")

# Criar diret√≥rios aninhados (cria toda a estrutura)
os.makedirs("pasta1/pasta2/pasta3", exist_ok=True)
print("‚úÖ Estrutura de pastas criada!")

# exist_ok=True evita erro se a pasta j√° existir
os.makedirs("nova_pasta", exist_ok=True)
print("‚úÖ Sem erro mesmo se pasta j√° existir")

# Criar estrutura para organizar arquivos por data
ano = "2025"
mes = "01"
os.makedirs(os.path.join("relatorios", ano, mes), exist_ok=True)
print("‚úÖ Estrutura criada: relatorios/2025/01/")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">‚úÖ Pasta criada!
‚úÖ Estrutura de pastas criada!
‚úÖ Sem erro mesmo se pasta j√° existir
‚úÖ Estrutura criada: relatorios/2025/01/</div>
                </div>

                    <h3>Mover, copiar e remover arquivos:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import os
import shutil  # Para opera√ß√µes de arquivos mais avan√ßadas

# Remover arquivo
arquivo_temp = "temp.txt"
if os.path.exists(arquivo_temp):
    os.remove(arquivo_temp)
    print(f"‚úÖ Arquivo '{arquivo_temp}' removido!")

# Renomear/mover arquivo
if os.path.exists("antigo.txt"):
    os.rename("antigo.txt", "novo.txt")
    print("‚úÖ Arquivo renomeado!")

# Copiar arquivo
if os.path.exists("original.csv"):
    shutil.copy("original.csv", "backup.csv")
    print("‚úÖ Arquivo copiado!")

# Remover diret√≥rio vazio
if os.path.exists("pasta_vazia") and os.path.isdir("pasta_vazia"):
    os.rmdir("pasta_vazia")
    print("‚úÖ Diret√≥rio vazio removido!")

# Remover diret√≥rio e todo seu conte√∫do
if os.path.exists("pasta_com_conteudo"):
    shutil.rmtree("pasta_com_conteudo")
    print("‚úÖ Diret√≥rio e conte√∫do removidos!")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">‚úÖ Arquivo removido!
‚úÖ Arquivo renomeado!
‚úÖ Arquivo copiado!
‚úÖ Diret√≥rio vazio removido!
‚úÖ Diret√≥rio e conte√∫do removidos!</div>
            </div>

                    <h3>Exemplo pr√°tico: Organizar arquivos por extens√£o:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import os
import shutil

def organizar_arquivos(diretorio="."):
    """Organiza arquivos em pastas por extens√£o."""
    
    # Criar pastas para cada tipo de arquivo
    tipos = {
        '.txt': 'Textos',
        '.csv': 'Planilhas',
        '.xlsx': 'Excel',
        '.pdf': 'PDFs',
        '.jpg': 'Imagens',
        '.png': 'Imagens'
    }
    
    # Criar pastas
    for pasta in set(tipos.values()):
        os.makedirs(pasta, exist_ok=True)
    
    # Mover arquivos
    arquivos_movidos = 0
    for arquivo in os.listdir(diretorio):
        caminho_arquivo = os.path.join(diretorio, arquivo)
        
        # Pular se for pasta ou arquivo Python
        if os.path.isdir(caminho_arquivo) or arquivo.endswith('.py'):
            continue
        
        extensao = os.path.splitext(arquivo)[1].lower()
        
        if extensao in tipos:
            pasta_destino = tipos[extensao]
            destino = os.path.join(pasta_destino, arquivo)
            shutil.move(caminho_arquivo, destino)
            arquivos_movidos += 1
            print(f"üì¶ Movido: {arquivo} ‚Üí {pasta_destino}/")
    
    print(f"\n‚úÖ {arquivos_movidos} arquivos organizados!")

# Executar organiza√ß√£o
organizar_arquivos()</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">üì¶ Movido: dados.txt ‚Üí Textos/
üì¶ Movido: vendas.csv ‚Üí Planilhas/
üì¶ Movido: relatorio.xlsx ‚Üí Excel/
üì¶ Movido: imagem.jpg ‚Üí Imagens/

‚úÖ 4 arquivos organizados!</div>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìã</span>Manipula√ß√£o de Arquivos JSON</h2>
                <h3>Trabalhando com dados estruturados em JSON</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    JSON (JavaScript Object Notation) √© um formato popular para armazenar e trocar dados.
                    Python tem suporte nativo para JSON atrav√©s do m√≥dulo <code>json</code>.
                </p>
                
                <div class="slide-content">
                    <h3>O que √© JSON?</h3>
                    <ul>
                        <li>Formato de texto simples e leg√≠vel</li>
                        <li>Estrutura similar a dicion√°rios Python</li>
                        <li>Usado em APIs, configura√ß√µes, dados estruturados</li>
                        <li>F√°cil de ler e escrever em qualquer linguagem</li>
                    </ul>

                    <h3>Exemplo de arquivo JSON:</h3>
                <div class="code-block">
                        <code># dados.json
{
    "nome": "Jo√£o Silva",
    "idade": 30,
    "cidade": "S√£o Paulo",
    "hobbies": ["leitura", "ciclismo", "programa√ß√£o"],
    "ativo": true
}</code>
                    </div>

                    <h3>Ler arquivo JSON:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import json

# Ler arquivo JSON
with open('dados.json', 'r', encoding='utf-8') as arquivo:
    dados = json.load(arquivo)  # Converte JSON para dicion√°rio Python

print(f"Nome: {dados['nome']}")
print(f"Idade: {dados['idade']}")
print(f"Hobbies: {', '.join(dados['hobbies'])}")

# Acessar dados aninhados
print(f"Cidade: {dados['cidade']}")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">Nome: Jo√£o Silva
Idade: 30
Hobbies: leitura, ciclismo, programa√ß√£o
Cidade: S√£o Paulo</div>
                    </div>

                    <h3>Escrever arquivo JSON:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import json

# Dados em Python (dicion√°rio)
pessoa = {
    "nome": "Maria Santos",
    "idade": 25,
    "cidade": "Rio de Janeiro",
    "hobbies": ["cinema", "nata√ß√£o"],
    "ativo": True,
    "salario": 5000.50
}

# Escrever em arquivo JSON
with open('pessoa.json', 'w', encoding='utf-8') as arquivo:
    json.dump(pessoa, arquivo, indent=2, ensure_ascii=False)

print("‚úÖ Arquivo JSON criado!")

# indent=2 deixa o JSON formatado (bonito)
# ensure_ascii=False permite caracteres especiais (acentos)

# Converter dicion√°rio para string JSON
json_string = json.dumps(pessoa, indent=2, ensure_ascii=False)
print("\nJSON como string:")
print(json_string)</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">‚úÖ Arquivo JSON criado!

JSON como string:
{
  "nome": "Maria Santos",
  "idade": 25,
  "cidade": "Rio de Janeiro",
  "hobbies": [
    "cinema",
    "nata√ß√£o"
  ],
  "ativo": true,
  "salario": 5000.5
}</div>
                </div>

                    <h3>Exemplo pr√°tico: Salvar e carregar configura√ß√µes:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import json
import os

def carregar_configuracao(arquivo="config.json"):
    """Carrega configura√ß√µes de um arquivo JSON."""
    if os.path.exists(arquivo):
        with open(arquivo, 'r', encoding='utf-8') as f:
            return json.load(f)
    else:
        # Configura√ß√£o padr√£o
        return {
            "idioma": "pt-BR",
            "tema": "claro",
            "notificacoes": True
        }

def salvar_configuracao(config, arquivo="config.json"):
    """Salva configura√ß√µes em um arquivo JSON."""
    with open(arquivo, 'w', encoding='utf-8') as f:
        json.dump(config, f, indent=2, ensure_ascii=False)
    print(f"‚úÖ Configura√ß√µes salvas em {arquivo}")

# Usar configura√ß√µes
config = carregar_configuracao()
print(f"Idioma atual: {config['idioma']}")
print(f"Tema: {config['tema']}")

# Modificar e salvar
config['tema'] = 'escuro'
config['idioma'] = 'en-US'
salvar_configuracao(config)</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">Idioma atual: pt-BR
Tema: claro
‚úÖ Configura√ß√µes salvas em config.json</div>
            </div>

                    <h3>Exemplo pr√°tico: Trabalhar com lista de objetos JSON:</h3>
                    <div class="jupyter-cell">
                        <div class="jupyter-input"></div>
                        <div class="jupyter-code">import json

# Dados: lista de produtos
produtos = [
    {"id": 1, "nome": "Notebook", "preco": 2500.00, "estoque": 10},
    {"id": 2, "nome": "Mouse", "preco": 50.00, "estoque": 50},
    {"id": 3, "nome": "Teclado", "preco": 120.00, "estoque": 30}
]

# Salvar produtos em JSON
with open('produtos.json', 'w', encoding='utf-8') as arquivo:
    json.dump(produtos, arquivo, indent=2, ensure_ascii=False)

print("‚úÖ Produtos salvos em JSON!")

# Ler e processar produtos
with open('produtos.json', 'r', encoding='utf-8') as arquivo:
    produtos_carregados = json.load(arquivo)

print("\nüì¶ PRODUTOS CARREGADOS:")
total_estoque = 0
for produto in produtos_carregados:
    print(f"  - {produto['nome']}: R$ {produto['preco']:.2f} (Estoque: {produto['estoque']})")
    total_estoque += produto['preco'] * produto['estoque']

print(f"\nüí∞ Valor total em estoque: R$ {total_estoque:.2f}")

# Filtrar produtos caros
produtos_caros = [p for p in produtos_carregados if p['preco'] > 100]
print(f"\nüíé Produtos acima de R$ 100: {len(produtos_caros)}")</div>
                        <div class="jupyter-output"></div>
                        <div class="jupyter-print">‚úÖ Produtos salvos em JSON!

üì¶ PRODUTOS CARREGADOS:
  - Notebook: R$ 2500.00 (Estoque: 10)
  - Mouse: R$ 50.00 (Estoque: 50)
  - Teclado: R$ 120.00 (Estoque: 30)

üí∞ Valor total em estoque: R$ 30100.00

üíé Produtos acima de R$ 100: 2</div>
                </div>

                    <div class="destaque" style="margin-top: 20px;">
                        <strong>üí° Dicas importantes sobre JSON:</strong>
                        <ul>
                            <li><code>json.load()</code> - l√™ de arquivo e converte para Python</li>
                            <li><code>json.dump()</code> - escreve Python em arquivo JSON</li>
                            <li><code>json.loads()</code> - converte string JSON para Python</li>
                            <li><code>json.dumps()</code> - converte Python para string JSON</li>
                            <li>Use <code>indent=2</code> para JSON formatado (leg√≠vel)</li>
                            <li>Use <code>ensure_ascii=False</code> para preservar acentos</li>
                    </ul>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">‚úèÔ∏è</span>Exerc√≠cios - Manipula√ß√£o de Arquivos</h2>

                <div class="exemplo-box">
                    <strong>Exerc√≠cio 1: Ler e Processar Arquivo</strong>
                    <p>Crie um arquivo texto com 5 nomes, um por linha. Leia o arquivo e mostre cada nome com n√∫mero.</p>
                    <details>
                        <summary>Ver solu√ß√£o</summary>
                        <div class="slide-content" style="margin-top: 10px;">
                            <div class="jupyter-cell">
                                <div class="jupyter-input"></div>
                                <div class="jupyter-code"># Criar arquivo
with open('nomes.txt', 'w', encoding='utf-8') as arquivo:
    arquivo.write("Maria\nJo√£o\nAna\nPedro\nCarla\n")

# Ler e mostrar
with open('nomes.txt', 'r', encoding='utf-8') as arquivo:
    for i, nome in enumerate(arquivo, 1):
        print(f"{i}. {nome.strip()}")</div>
                                <div class="jupyter-output"></div>
                                <div class="jupyter-print">1. Maria
2. Jo√£o
3. Ana
4. Pedro
5. Carla</div>
                            </div>
                        </div>
                    </details>
                </div>

                <div class="exemplo-box">
                    <strong>Exerc√≠cio 2: Processar CSV de Vendas</strong>
                    <p>Leia um CSV de vendas e calcule o total vendido por vendedor.</p>
                    <details>
                        <summary>Ver solu√ß√£o</summary>
                        <div class="slide-content" style="margin-top: 10px;">
                            <div class="jupyter-cell">
                                <div class="jupyter-input"></div>
                                <div class="jupyter-code">import csv

vendas_por_vendedor = {}

with open('vendas.csv', 'r', encoding='utf-8') as arquivo:
    leitor = csv.DictReader(arquivo)
    for registro in leitor:
        vendedor = registro['Vendedor']
        valor = float(registro['Valor'])
        
        if vendedor not in vendas_por_vendedor:
            vendas_por_vendedor[vendedor] = 0
        vendas_por_vendedor[vendedor] += valor

print("üí∞ VENDAS POR VENDEDOR:")
for vendedor, total in vendas_por_vendedor.items():
    print(f"{vendedor}: R$ {total:.2f}")</div>
                                <div class="jupyter-output"></div>
                                <div class="jupyter-print">üí∞ VENDAS POR VENDEDOR:
Jo√£o: R$ 500.00
Maria: R$ 700.00
Pedro: R$ 300.00</div>
                            </div>
                        </div>
                    </details>
                </div>
            </div>

            <div class="controles">
                <button class="btn btn-voltar-menu" onclick="voltarMenu()">‚Üê Voltar ao Menu</button>
                <button class="btn" onclick="slideAnterior()">‚Üê Anterior</button>
                <span class="contador-slides" id="contador8">1 / 16</span>
                <button class="btn" onclick="proximoSlide()">Pr√≥ximo ‚Üí</button>
            </div>
        </div>
