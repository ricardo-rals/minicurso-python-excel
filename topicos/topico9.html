<div id="topico9" class="slides-container">
    <div class="slide active">
                <h2><span class="emoji">üìä</span>T√≥pico 9: Trabalhando com Arquivos Excel</h2>
                <h3>Por que automatizar Excel com Python?</h3>
                <ul>
                    <li><strong>Velocidade:</strong> Processar milhares de linhas em segundos</li>
                    <li><strong>Precis√£o:</strong> Eliminar erros humanos em tarefas repetitivas</li>
                    <li><strong>Produtividade:</strong> Automatizar relat√≥rios e an√°lises</li>
                    <li><strong>Escalabilidade:</strong> Trabalhar com m√∫ltiplos arquivos simultaneamente</li>
                </ul>

                <div class="exemplo-box">
                    <strong>üí° Neste t√≥pico voc√™ vai aprender:</strong>
                    <ul>
                        <li>Criar e manipular planilhas Excel com <strong>Openpyxl</strong></li>
                        <li>Analisar dados com <strong>Pandas</strong></li>
                        <li>Filtrar, ordenar e transformar dados</li>
                        <li>Aplicar formata√ß√£o e estilos</li>
                    </ul>
                </div>

                <div class="destaque">
                    <strong>üì¶ Bibliotecas necess√°rias:</strong>
                    <div class="code-block" style="margin-top: 10px;">
                        <code>pip install openpyxl pandas</code>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìñ</span>Dicion√°rio de Fun√ß√µes e Par√¢metros</h2>
                <h3>Entendendo os conceitos principais</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    Antes de come√ßar, vamos entender o que significa cada fun√ß√£o e par√¢metro que voc√™ vai usar!
                </p>
                
                <div class="slide-content">
                    <h3>üîß Openpyxl - Classes e Fun√ß√µes:</h3>
                    
                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>Workbook()</code></strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Cria um novo arquivo Excel (workbook). √â como criar uma nova planilha do zero.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>wb = Workbook()  # Cria um novo arquivo Excel vazio</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>load_workbook(arquivo)</code></strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Abre um arquivo Excel existente para leitura ou edi√ß√£o.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>wb = load_workbook("vendas.xlsx")  # Abre arquivo existente</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>wb.active</code></strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Retorna a aba (worksheet) ativa/atual do workbook. √â a aba que est√° aberta no Excel.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>ws = wb.active  # Pega a aba ativa</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>ws.title</code></strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Nome da aba (worksheet). √â o nome que aparece na guia inferior do Excel.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>ws.title = "Vendas"  # Renomeia a aba</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>wb.save(arquivo)</code></strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Salva o workbook em um arquivo. Sempre chame isso ap√≥s fazer altera√ß√µes!
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>wb.save("vendas.xlsx")  # Salva o arquivo</code>
                        </div>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üêº</span>Dicion√°rio - Pandas (pd.read_excel)</h2>
                <h3>Par√¢metros do pd.read_excel()</h3>
                
                <div class="slide-content">
                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>pd.read_excel(arquivo, ...)</code></strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Fun√ß√£o principal para ler arquivos Excel e converter em DataFrame (tabela do Pandas).
                        </p>
                    </div>

                    <h3>üìã Par√¢metros principais:</h3>
                    
                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>arquivo</code> (obrigat√≥rio)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Caminho do arquivo Excel (.xlsx ou .xls) que voc√™ quer ler.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>df = pd.read_excel("vendas.xlsx")</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>sheet_name</code> (opcional)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Qual aba ler do arquivo. Pode ser:
                            <ul style="margin: 5px 0 0 20px; font-size: 0.9em;">
                                <li>N√∫mero (0, 1, 2...) - √≠ndice da aba (primeira = 0)</li>
                                <li>String ("Vendas") - nome da aba</li>
                                <li><code>None</code> - l√™ todas as abas (retorna dicion√°rio)</li>
                            </ul>
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>df = pd.read_excel("vendas.xlsx", sheet_name=0)  # Primeira aba
df = pd.read_excel("vendas.xlsx", sheet_name="Vendas")  # Aba chamada "Vendas"
abas = pd.read_excel("vendas.xlsx", sheet_name=None)  # Todas as abas</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>engine</code> (opcional)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Qual biblioteca usar para ler o arquivo:
                            <ul style="margin: 5px 0 0 20px; font-size: 0.9em;">
                                <li><code>'openpyxl'</code> - para arquivos .xlsx (padr√£o)</li>
                                <li><code>'xlrd'</code> - para arquivos .xls antigos</li>
                            </ul>
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>df = pd.read_excel("vendas.xlsx", engine='openpyxl')  # .xlsx
df = pd.read_excel("vendas.xls", engine='xlrd')  # .xls antigo</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>header</code> (opcional)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Qual linha usar como cabe√ßalho (nomes das colunas):
                            <ul style="margin: 5px 0 0 20px; font-size: 0.9em;">
                                <li><code>0</code> (padr√£o) - primeira linha √© cabe√ßalho</li>
                                <li><code>None</code> - n√£o h√° cabe√ßalho (cria nomes autom√°ticos)</li>
                                <li>N√∫mero - linha espec√≠fica como cabe√ßalho</li>
                            </ul>
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>df = pd.read_excel("vendas.xlsx", header=0)  # Linha 1 = cabe√ßalho</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>index_col</code> (opcional)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Qual coluna usar como √≠ndice (ID) do DataFrame. Geralmente <code>None</code> ou <code>0</code>.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>df = pd.read_excel("vendas.xlsx", index_col=0)  # Primeira coluna = √≠ndice</code>
                        </div>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üíæ</span>Dicion√°rio - Pandas (pd.to_excel)</h2>
                <h3>Par√¢metros do pd.to_excel()</h3>
                
                <div class="slide-content">
                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>df.to_excel(arquivo, ...)</code></strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Salva um DataFrame em um arquivo Excel.
                        </p>
                    </div>

                    <h3>üìã Par√¢metros principais:</h3>
                    
                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>arquivo</code> (obrigat√≥rio)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Nome do arquivo onde salvar (.xlsx).
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>df.to_excel("saida.xlsx")</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>sheet_name</code> (opcional)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Nome da aba onde salvar. Padr√£o √© "Sheet1".
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>df.to_excel("saida.xlsx", sheet_name="Vendas")</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>index</code> (opcional, padr√£o: True)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Se <code>True</code>, salva o √≠ndice do DataFrame como primeira coluna.
                            Geralmente use <code>index=False</code> para n√£o salvar n√∫meros de linha.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>df.to_excel("saida.xlsx", index=False)  # N√£o salva n√∫meros de linha</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>engine</code> (opcional)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Biblioteca para escrever. Use <code>'openpyxl'</code> para .xlsx.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>df.to_excel("saida.xlsx", engine='openpyxl')</code>
                        </div>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìö</span>Dicion√°rio - Outros Conceitos Importantes</h2>
                <h3>Termos e objetos que voc√™ vai encontrar</h3>
                
                <div class="slide-content">
                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>DataFrame (df)</code></strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            √â uma tabela do Pandas, como uma planilha Excel em Python. Tem linhas e colunas.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>df = pd.DataFrame({'Nome': ['Jo√£o', 'Maria'], 'Idade': [25, 30]})</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>pd.ExcelWriter()</code></strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Permite salvar m√∫ltiplas abas em um √∫nico arquivo Excel. Use com <code>with</code>.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>with pd.ExcelWriter("relatorio.xlsx") as writer:
    df1.to_excel(writer, sheet_name="Aba1")
    df2.to_excel(writer, sheet_name="Aba2")</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>ws.iter_rows()</code> (Openpyxl)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Itera sobre linhas da planilha. √ötil para ler dados linha por linha.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>for row in ws.iter_rows(min_row=1, max_row=10, values_only=True):
    print(row)  # values_only=True retorna apenas valores, n√£o objetos</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>ws['A1']</code> (Openpyxl)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Acessa uma c√©lula espec√≠fica usando nota√ß√£o Excel (A1, B2, etc.).
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>ws['A1'] = "Produto"  # Escreve na c√©lula A1
valor = ws['A1'].value  # L√™ o valor da c√©lula A1</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>df.groupby()</code> (Pandas)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Agrupa dados por uma ou mais colunas, permitindo fazer c√°lculos por grupo.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>vendas_por_regiao = df.groupby('Regi√£o')['Vendas'].sum()</code>
                        </div>
                    </div>

                    <div class="destaque" style="margin: 15px 0;">
                        <strong><code>df.fillna()</code> (Pandas)</strong>
                        <p style="margin: 5px 0; font-size: 0.95em;">
                            Preenche valores faltantes (NaN) com um valor espec√≠fico ou m√©todo.
                        </p>
                        <div class="code-block" style="margin-top: 5px; font-size: 0.85em;">
                            <code>df.fillna(0)  # Preenche todos NaN com 0
df.fillna(df['Pre√ßo'].mean())  # Preenche com m√©dia</code>
                        </div>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìö</span>Biblioteca Openpyxl</h2>
                <h3>O que √© Openpyxl?</h3>
        <p style="font-size: 1.1em; margin: 20px 0;">
                    Openpyxl √© uma biblioteca Python para ler e escrever arquivos Excel (formato .xlsx).
                    Ela permite criar planilhas do zero e aplicar formata√ß√µes como o Excel faz!
                </p>

                <h3>Criando sua primeira planilha:</h3>
                <div class="code-block">
                    <code>from openpyxl import Workbook

# Criar uma nova planilha
wb = Workbook()
ws = wb.active
ws.title = "Vendas"

# Escrever dados nas c√©lulas
ws['A1'] = "Produto"
ws['B1'] = "Quantidade"
ws['C1'] = "Pre√ßo"

ws['A2'] = "Notebook"
ws['B2'] = 5
ws['C2'] = 2500.00

# Salvar a planilha
wb.save("vendas.xlsx")
print("‚úÖ Planilha criada com sucesso!")</code>
                </div>

        <div class="destaque">
                    <strong>üí° Importante:</strong>
                    Openpyxl trabalha com arquivos .xlsx (Excel 2010+). Para arquivos .xls antigos, use Pandas ou xlrd.
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìã</span>Trabalhando com Arquivos .xls (Formato Antigo)</h2>
                <h3>Lendo planilhas do Excel 97-2003</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    Arquivos <code>.xls</code> s√£o do formato antigo do Excel (97-2003). Eles n√£o podem ser lidos
                    diretamente com <code>openpyxl</code>, mas podem ser trabalhados com <strong>Pandas</strong> ou <strong>xlrd</strong>.
                </p>
                
                <div class="slide-content">
                    <h3>Diferen√ßas entre .xls e .xlsx:</h3>
                    <table style="width: 100%; font-size: 0.9em; margin: 20px 0;">
                        <tr>
                            <th>Formato</th>
                            <th>Vers√£o Excel</th>
                            <th>Biblioteca Python</th>
                            <th>Limita√ß√µes</th>
                        </tr>
                        <tr>
                            <td><code>.xls</code></td>
                            <td>97-2003 (antigo)</td>
                            <td>xlrd (ler), xlwt (escrever) ou Pandas</td>
                            <td>M√°ximo 65.536 linhas, menos recursos</td>
                        </tr>
                        <tr>
                            <td><code>.xlsx</code></td>
                            <td>2007+ (moderno)</td>
                            <td>openpyxl ou Pandas</td>
                            <td>Milh√µes de linhas, mais recursos</td>
                        </tr>
                    </table>

                    <h3>Ler arquivo .xls com Pandas (mais f√°cil):</h3>
                    <div class="code-block">
                        <code>import pandas as pd

# Ler arquivo .xls (formato antigo)
# Pandas detecta automaticamente o formato
df = pd.read_excel("vendas_antigas.xls", engine='xlrd')

print("üìä DADOS DO ARQUIVO .XLS:")
print(df)

# ‚ö†Ô∏è IMPORTANTE: Para ler .xls, voc√™ precisa instalar xlrd:
# pip install xlrd

# Se o arquivo tiver m√∫ltiplas abas
df_aba1 = pd.read_excel("vendas_antigas.xls", sheet_name=0, engine='xlrd')
df_aba2 = pd.read_excel("vendas_antigas.xls", sheet_name="Vendas", engine='xlrd')

print("\nPrimeira aba:")
print(df_aba1)</code>
        </div>

                    <div class="destaque" style="margin-top: 20px;">
                        <strong>üì¶ Instala√ß√£o necess√°ria:</strong>
                        <div class="code-block" style="margin-top: 10px;">
                            <code>pip install xlrd  # Para ler .xls
pip install openpyxl  # Para ler .xlsx</code>
                        </div>
                    </div>
        </div>
    </div>

    <div class="slide">
                <h2><span class="emoji">üîÑ</span>Converter .xls para .xlsx</h2>
                <h3>Modernizando planilhas antigas</h3>
                
                <div class="slide-content">
                    <h3>Converter arquivo .xls para .xlsx:</h3>
                    <div class="code-block">
                        <code>import pandas as pd

# Ler arquivo .xls antigo
df = pd.read_excel("dados_antigos.xls", engine='xlrd')

print(f"‚úÖ Arquivo .xls lido: {len(df)} linhas")

# Salvar como .xlsx (formato moderno)
df.to_excel("dados_modernos.xlsx", index=False, engine='openpyxl')

print("‚úÖ Arquivo convertido para .xlsx!")

# Converter todas as abas
arquivo_antigo = "relatorio_antigo.xls"
arquivo_novo = "relatorio_novo.xlsx"

# Ler todas as abas
abas_xls = pd.read_excel(arquivo_antigo, sheet_name=None, engine='xlrd')

# Salvar todas as abas no novo formato
with pd.ExcelWriter(arquivo_novo, engine='openpyxl') as writer:
    for nome_aba, df_aba in abas_xls.items():
        df_aba.to_excel(writer, sheet_name=nome_aba, index=False)

print(f"‚úÖ Convertido {len(abas_xls)} abas para .xlsx!")</code>
                    </div>

                    <h3>Exemplo pr√°tico: Processar m√∫ltiplos arquivos .xls:</h3>
        <div class="code-block">
                        <code>import pandas as pd
import os

def converter_xls_para_xlsx(pasta="arquivos_antigos"):
    """Converte todos os arquivos .xls de uma pasta para .xlsx."""
    
    arquivos_convertidos = 0
    
    # Listar todos os arquivos .xls
    for arquivo in os.listdir(pasta):
        if arquivo.endswith('.xls'):
            caminho_antigo = os.path.join(pasta, arquivo)
            
            # Ler arquivo .xls
            try:
                df = pd.read_excel(caminho_antigo, engine='xlrd')
                
                # Criar nome do novo arquivo
                nome_novo = arquivo.replace('.xls', '.xlsx')
                caminho_novo = os.path.join(pasta, nome_novo)
                
                # Salvar como .xlsx
                df.to_excel(caminho_novo, index=False, engine='openpyxl')
                
                print(f"‚úÖ Convertido: {arquivo} ‚Üí {nome_novo}")
                arquivos_convertidos += 1
                
            except Exception as e:
                print(f"‚ùå Erro ao converter {arquivo}: {e}")
    
    print(f"\n‚úÖ Total de arquivos convertidos: {arquivos_convertidos}")

# Executar convers√£o
converter_xls_para_xlsx()</code>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìö</span>Ler .xls com xlrd (Biblioteca Dedicada)</h2>
                <h3>Controle fino sobre arquivos antigos</h3>
                
                <div class="slide-content">
                    <h3>Usando xlrd para ler .xls:</h3>
                    <div class="code-block">
                        <code>import xlrd

# Abrir arquivo .xls
workbook = xlrd.open_workbook("vendas_antigas.xls")

# Listar abas
print("üìã Abas dispon√≠veis:")
for i, sheet_name in enumerate(workbook.sheet_names()):
    print(f"  {i}: {sheet_name}")

# Selecionar primeira aba
sheet = workbook.sheet_by_index(0)
# ou: sheet = workbook.sheet_by_name("Vendas")

print(f"\nüìä Dados da aba '{sheet.name}':")
print(f"  Linhas: {sheet.nrows}")
print(f"  Colunas: {sheet.ncols}")

# Ler c√©lulas espec√≠ficas
print(f"\nC√©lula A1: {sheet.cell_value(0, 0)}")
print(f"C√©lula B2: {sheet.cell_value(1, 1)}")

# Ler linha inteira
linha_1 = sheet.row_values(0)
print(f"\nPrimeira linha (cabe√ßalho): {linha_1}")

# Ler todas as linhas
print("\nüìã DADOS COMPLETOS:")
for row_idx in range(sheet.nrows):
    linha = sheet.row_values(row_idx)
    print(f"Linha {row_idx}: {linha}")

# Ler coluna inteira
coluna_a = sheet.col_values(0)
print(f"\nColuna A: {coluna_a}")</code>
                    </div>

                    <h3>Processar dados com xlrd:</h3>
                    <div class="code-block">
                        <code>import xlrd

# Ler arquivo .xls
workbook = xlrd.open_workbook("vendas_antigas.xls")
sheet = workbook.sheet_by_index(0)

# Processar dados
vendas_total = 0
produtos = []

# Pular cabe√ßalho (linha 0)
for row_idx in range(1, sheet.nrows):
    produto = sheet.cell_value(row_idx, 0)
    quantidade = sheet.cell_value(row_idx, 1)
    preco = sheet.cell_value(row_idx, 2)
    
    # Verificar tipo de c√©lula
    tipo_quantidade = sheet.cell_type(row_idx, 1)
    tipo_preco = sheet.cell_type(row_idx, 2)
    
    # xlrd.XL_CELL_NUMBER = 2, xlrd.XL_CELL_TEXT = 1
    if tipo_quantidade == 2 and tipo_preco == 2:
        total = quantidade * preco
        vendas_total += total
        
        produtos.append({
            'produto': produto,
            'quantidade': quantidade,
            'preco': preco,
            'total': total
        })

print("üí∞ VENDAS PROCESSADAS:")
for p in produtos:
    print(f"  {p['produto']}: {p['quantidade']} √ó R$ {p['preco']:.2f} = R$ {p['total']:.2f}")

print(f"\nüíµ Total geral: R$ {vendas_total:.2f}")</code>
                    </div>

                    <div class="destaque" style="margin-top: 20px;">
                        <strong>‚ö†Ô∏è Nota importante sobre xlrd:</strong>
                        <ul>
                            <li>A vers√£o 2.0+ do xlrd <strong>n√£o suporta mais arquivos .xls</strong> (apenas .xlsx)</li>
                            <li>Para ler .xls, use: <code>pip install xlrd==1.2.0</code></li>
                            <li>Ou use Pandas com engine='xlrd' (vers√£o antiga)</li>
                            <li><strong>Recomenda√ß√£o:</strong> Converta arquivos .xls para .xlsx quando poss√≠vel</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üé®</span>Formata√ß√£o com Openpyxl</h2>
                <h3>Deixando suas planilhas profissionais:</h3>

                <div class="code-block">
                    <code>from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill, Alignment

wb = Workbook()
ws = wb.active

# Escrever cabe√ßalho
ws['A1'] = "Produto"
ws['B1'] = "Quantidade"
ws['C1'] = "Pre√ßo Unit√°rio"

# Formata√ß√£o do cabe√ßalho
header_fill = PatternFill(
    start_color="4472C4",
    end_color="4472C4",
    fill_type="solid"
)
header_font = Font(color="FFFFFF", bold=True, size=12)

for cell in ws[1]:  # Linha 1 (cabe√ßalho)
    cell.fill = header_fill
    cell.font = header_font
    cell.alignment = Alignment(horizontal="center")

# Adicionar dados
produtos = [
    ["Notebook", 5, 2500.00],
    ["Mouse", 20, 45.00],
    ["Teclado", 15, 120.00]
]

for i, produto in enumerate(produtos, start=2):
    ws[f'A{i}'] = produto[0]
    ws[f'B{i}'] = produto[1]
    ws[f'C{i}'] = produto[2]

wb.save("vendas_formatada.xlsx")</code>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìê</span>F√≥rmulas do Excel com Openpyxl</h2>
                <h3>Inserindo f√≥rmulas nas c√©lulas:</h3>

                <div class="code-block">
                    <code>from openpyxl import Workbook

wb = Workbook()
ws = wb.active

# Cabe√ßalhos
ws['A1'] = "Produto"
ws['B1'] = "Quantidade"
ws['C1'] = "Pre√ßo Unit."
ws['D1'] = "Total"

# Dados
ws['A2'] = "Notebook"
ws['B2'] = 5
ws['C2'] = 2500

# F√ìRMULA: Total = Quantidade √ó Pre√ßo
ws['D2'] = "=B2*C2"  # F√≥rmula do Excel!

# Mais produtos
ws['A3'] = "Mouse"
ws['B3'] = 20
ws['C3'] = 45
ws['D3'] = "=B3*C3"

# Soma total de todas as vendas
ws['D5'] = "TOTAL:"
ws['E5'] = "=SUM(D2:D4)"

wb.save("vendas_com_formulas.xlsx")</code>
                </div>

                <div class="exemplo-box">
                    <strong>‚ú® Dica Pro:</strong>
                    As f√≥rmulas s√£o calculadas automaticamente quando voc√™ abre o arquivo no Excel!
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìñ</span>Lendo Planilhas Existentes</h2>
                <h3>Abrindo e lendo dados:</h3>

                <div class="code-block">
                    <code>from openpyxl import load_workbook

# Abrir planilha existente
wb = load_workbook("vendas.xlsx")
ws = wb.active

# Ler uma c√©lula espec√≠fica
print(ws['A1'].value)  # Produto

# Ler uma linha inteira
for cell in ws[2]:  # Linha 2
    print(cell.value)

# Iterar por todas as linhas
for row in ws.iter_rows(min_row=1, max_row=10, values_only=True):
    print(row)

# Exemplo: Ler dados e processar
print("\nüìä PRODUTOS:")
for row in ws.iter_rows(min_row=2, values_only=True):
    produto, qtd, preco = row[0], row[1], row[2]
    total = qtd * preco
    print(f"{produto}: {qtd} un. √ó R$ {preco:.2f} = R$ {total:.2f}")</code>
        </div>

         <div class="destaque">
                    <strong>‚ö†Ô∏è Aten√ß√£o:</strong>
                    Use <code>values_only=True</code> para obter apenas os valores, sem objetos de c√©lula.
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üêº</span>Biblioteca Pandas</h2>
                <h3>O poder da an√°lise de dados!</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    Pandas √© a biblioteca mais popular para an√°lise de dados em Python.
                    Ela trabalha com <strong>DataFrames</strong>, que s√£o como tabelas Excel turbinadas!
                </p>

                <h3>Lendo Excel com Pandas:</h3>
                <div class="code-block">
                    <code>import pandas as pd

# Ler planilha Excel
df = pd.read_excel("vendas.xlsx")

# Exibir os dados
print(df)

# Sa√≠da:
#     Produto  Quantidade  Pre√ßo
# 0  Notebook           5  2500.0
# 1     Mouse          20    45.0
# 2   Teclado          15   120.0

# Informa√ß√µes b√°sicas
print(df.info())
print(df.describe())  # Estat√≠sticas descritivas</code>
                </div>

                <div class="exemplo-box">
                    <strong>üí° Vantagem do Pandas:</strong>
                    Opera√ß√µes complexas em poucas linhas de c√≥digo!
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üîç</span>Opera√ß√µes B√°sicas com Pandas</h2>

                <div class="code-block">
                    <code>import pandas as pd

df = pd.read_excel("vendas.xlsx")

# 1. Adicionar nova coluna calculada
df['Total'] = df['Quantidade'] * df['Pre√ßo']

# 2. Filtrar dados
produtos_caros = df[df['Pre√ßo'] > 100]
print("Produtos acima de R$ 100:")
print(produtos_caros)

# 3. Ordenar dados
df_ordenado = df.sort_values('Total', ascending=False)
print("\nProdutos por total de vendas:")
print(df_ordenado)

# 4. Estat√≠sticas
print(f"\nüìä ESTAT√çSTICAS:")
print(f"Total geral: R$ {df['Total'].sum():.2f}")
print(f"M√©dia de pre√ßo: R$ {df['Pre√ßo'].mean():.2f}")
print(f"Produto mais vendido: {df.loc[df['Quantidade'].idxmax(), 'Produto']}")

# 5. Salvar resultado
df.to_excel("vendas_analisadas.xlsx", index=False)
print("\n‚úÖ An√°lise salva!")</code>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üéØ</span>Filtragem Avan√ßada com Pandas</h2>

                <div class="code-block">
                    <code>import pandas as pd

df = pd.read_excel("vendas.xlsx")
df['Total'] = df['Quantidade'] * df['Pre√ßo']

# Filtros condicionais
# 1. Filtro simples
alta_quantidade = df[df['Quantidade'] > 10]

# 2. Filtros m√∫ltiplos (AND)
produtos_especiais = df[
    (df['Quantidade'] > 10) &
    (df['Pre√ßo'] > 100)
]

# 3. Filtros m√∫ltiplos (OR)
produtos_destaque = df[
    (df['Quantidade'] > 15) |
    (df['Pre√ßo'] > 1000)
]

# 4. Filtrar por lista de valores
produtos_selecionados = df[
    df['Produto'].isin(['Notebook', 'Monitor'])
]

# 5. Filtrar valores nulos
df_limpo = df[df['Pre√ßo'].notna()]

# 6. Buscar por texto
produtos_com_o = df[
    df['Produto'].str.contains('o', case=False)
]

print("Produtos que cont√™m 'o':")
print(produtos_com_o)</code>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìä</span>Agrupamento e Agrega√ß√£o</h2>

                <div class="code-block">
                    <code>import pandas as pd

# Exemplo com dados de vendas por regi√£o
dados = {
    'Regi√£o': ['Norte', 'Sul', 'Norte', 'Sul', 'Norte'],
    'Produto': ['Mouse', 'Teclado', 'Monitor', 'Mouse', 'Teclado'],
    'Vendas': [100, 150, 200, 120, 180],
    'Quantidade': [10, 15, 5, 12, 18]
}

df = pd.DataFrame(dados)

# 1. Agrupar por regi√£o
vendas_por_regiao = df.groupby('Regi√£o')['Vendas'].sum()
print("Vendas por regi√£o:")
print(vendas_por_regiao)

# 2. M√∫ltiplas agrega√ß√µes
resumo = df.groupby('Regi√£o').agg({
    'Vendas': ['sum', 'mean', 'count'],
    'Quantidade': ['sum', 'mean']
})
print("\nResumo completo:")
print(resumo)

# 3. Criar tabela din√¢mica
pivot = pd.pivot_table(
    df,
    values='Vendas',
    index='Regi√£o',
    columns='Produto',
    aggfunc='sum',
    fill_value=0
)
print("\nTabela Din√¢mica:")
print(pivot)</code>
        </div>
    </div>

    <div class="slide">
                <h2><span class="emoji">üîÑ</span>Transforma√ß√£o de Dados</h2>

        <div class="code-block">
            <code>import pandas as pd

df = pd.read_excel("vendas.xlsx")

# 1. Aplicar fun√ß√£o a uma coluna
df['Pre√ßo_com_desconto'] = df['Pre√ßo'].apply(lambda x: x * 0.9)

# 2. Categorizar valores
def categorizar_preco(preco):
    if preco > 500:
        return 'Premium'
    elif preco > 100:
        return 'Standard'
    else:
        return 'B√°sico'

df['Categoria'] = df['Pre√ßo'].apply(categorizar_preco)

# 3. Criar colunas condicionais
df['Status_Estoque'] = df['Quantidade'].apply(
    lambda x: 'Baixo' if x < 10 else 'M√©dio' if x < 20 else 'Alto'
)

# 4. Renomear colunas
df = df.rename(columns={
    'Quantidade': 'Qtd',
    'Pre√ßo': 'Valor_Unit'
})

# 5. Remover colunas
df = df.drop(['Categoria'], axis=1)

# 6. Ordenar colunas
df = df[['Produto', 'Qtd', 'Valor_Unit', 'Status_Estoque']]

print(df)</code>
        </div>
    </div>

    <div class="slide">
                <h2><span class="emoji">‚ö†Ô∏è</span>Tratamento de Missing Data (NaN)</h2>
                <h3>Lidando com valores faltantes em planilhas</h3>
                <p style="font-size: 1.1em; margin: 20px 0;">
                    Valores faltantes (NaN - Not a Number) s√£o muito comuns em planilhas Excel.
                    √â importante saber como identific√°-los e trat√°-los antes de fazer an√°lises.
                </p>

        <div class="code-block">
                    <code>import pandas as pd
import numpy as np

# Exemplo: DataFrame com valores faltantes
dados = {
    'Produto': ['Notebook', 'Mouse', 'Teclado', 'Monitor', 'WebCam'],
    'Quantidade': [5, 20, None, 8, 12],  # None = NaN
    'Pre√ßo': [2500.00, 45.00, 120.00, None, 150.00],
    'Vendedor': ['Jo√£o', None, 'Maria', 'Pedro', None]
}

df = pd.DataFrame(dados)
print("DataFrame original:")
print(df)

# Verificar valores faltantes
print("\nüìä Valores faltantes por coluna:")
print(df.isna().sum())  # Conta NaN por coluna

print("\nVerificar se h√° valores faltantes:")
print(df.isna().any().any())  # True se houver algum NaN</code>
                </div>

                <div class="exemplo-box">
                    <strong>üí° Importante:</strong>
                    Valores faltantes podem aparecer como <code>None</code>, <code>NaN</code>, c√©lulas vazias no Excel ou strings vazias.
        </div>
    </div>
    
    <div class="slide">
                <h2><span class="emoji">üóëÔ∏è</span>Remover Linhas com Missing Data</h2>

        <div class="code-block">
                    <code>import pandas as pd

df = pd.read_excel("vendas_com_nan.xlsx")

# 1. Remover linhas que t√™m QUALQUER valor faltante
df_sem_nan = df.dropna()
print("Linhas removidas (qualquer NaN):")
print(df_sem_nan)

# 2. Remover linhas onde TODAS as colunas s√£o NaN
df_sem_todos_nan = df.dropna(how='all')
print("\nLinhas removidas (todas NaN):")
print(df_sem_todos_nan)

# 3. Remover linhas onde colunas espec√≠ficas t√™m NaN
df_limpo = df.dropna(subset=['Quantidade', 'Pre√ßo'])
print("\nLinhas onde Quantidade ou Pre√ßo s√£o NaN removidas:")
print(df_limpo)

# 4. Ver quantas linhas foram removidas
linhas_originais = len(df)
linhas_finais = len(df_sem_nan)
print(f"\nLinhas removidas: {linhas_originais - linhas_finais}")</code>
        </div>

         <div class="destaque">
                    <strong>‚ö†Ô∏è Cuidado:</strong>
                    <code>dropna()</code> remove linhas permanentemente. Use com cuidado para n√£o perder dados importantes!
        </div>
    </div>

    <div class="slide">
                <h2><span class="emoji">üîß</span>Preencher Valores Faltantes</h2>

        <div class="code-block">
                    <code>import pandas as pd
import numpy as np

df = pd.read_excel("vendas.xlsx")

# 1. Preencher com um valor fixo
df_preenchido_zero = df.fillna(0)  # Preenche todos os NaN com 0
print("Preenchido com zero:")
print(df_preenchido_zero)

# 2. Preencher por coluna com valores diferentes
df_preenchido = df.fillna({
    'Quantidade': 0,      # Quantidade faltante = 0
    'Pre√ßo': df['Pre√ßo'].mean(),  # Pre√ßo faltante = m√©dia
    'Vendedor': 'N/A'     # Vendedor faltante = 'N/A'
})
print("\nPreenchido com estrat√©gias diferentes:")
print(df_preenchido)

# 3. Preencher com m√©todo forward fill (preenche com valor anterior)
df_ffill = df.fillna(method='ffill')
print("\nForward fill (valor anterior):")
print(df_ffill)

# 4. Preencher com m√©todo backward fill (preenche com pr√≥ximo valor)
df_bfill = df.fillna(method='bfill')
print("\nBackward fill (pr√≥ximo valor):")
print(df_bfill)

# 5. Preencher com m√©dia da coluna
df['Pre√ßo'].fillna(df['Pre√ßo'].mean(), inplace=True)
print("\nPre√ßo preenchido com m√©dia:")
print(df)</code>
                </div>
            </div>

            <div class="slide">
                <h2><span class="emoji">üìã</span>Quando Usar Cada Abordagem</h2>

                <table style="width: 100%; font-size: 0.9em; margin: 20px 0;">
                    <tr>
                        <th>M√©todo</th>
                        <th>Quando Usar</th>
                        <th>Exemplo</th>
                    </tr>
                    <tr>
                        <td><code>dropna()</code></td>
                        <td>Dados faltantes n√£o s√£o importantes ou h√° muitas linhas</td>
                        <td>Logs, dados temporais</td>
                    </tr>
                    <tr>
                        <td><code>fillna(0)</code></td>
                        <td>Valor zero faz sentido</td>
                        <td>Quantidade, estoque</td>
                    </tr>
                    <tr>
                        <td><code>fillna(mean())</code></td>
                        <td>M√©dia representa bem o valor</td>
                        <td>Pre√ßos, sal√°rios, idades</td>
                    </tr>
                    <tr>
                        <td><code>fillna('N/A')</code></td>
                        <td>Texto placeholder</td>
                        <td>Nomes, categorias</td>
                    </tr>
                    <tr>
                        <td><code>fillna(method='ffill')</code></td>
                        <td>Dados sequenciais (temporal)</td>
                        <td>Valores de a√ß√µes, temperatura</td>
                    </tr>
                </table>

                <div class="code-block">
                    <code>import pandas as pd

# Exemplo pr√°tico completo
df = pd.read_excel("vendas.xlsx")

# 1. Verificar situa√ß√£o inicial
print(f"Valores faltantes: {df.isna().sum().sum()}")

# 2. Estrat√©gia: Pre√ßo = m√©dia, Quantidade = 0
df['Pre√ßo'] = df['Pre√ßo'].fillna(df['Pre√ßo'].mean())
df['Quantidade'] = df['Quantidade'].fillna(0)

# 3. Remover linhas cr√≠ticas onde n√£o h√° produto
df = df.dropna(subset=['Produto'])

# 4. Verificar resultado
print(f"\nValores faltantes restantes: {df.isna().sum().sum()}")
print("\n‚úÖ Dados limpos e prontos para an√°lise!")</code>
        </div>
    </div>

    <div class="slide">
                <h2><span class="emoji">üíæ</span>Salvando Dados em Excel</h2>

                <div class="code-block">
                    <code>import pandas as pd

df = pd.read_excel("vendas.xlsx")

# 1. Salvar DataFrame simples
df.to_excel("saida.xlsx", index=False)

# 2. Salvar m√∫ltiplas abas
with pd.ExcelWriter("relatorio_completo.xlsx") as writer:
    df.to_excel(writer, sheet_name="Vendas", index=False)

    # Criar resumo
    resumo = df.groupby('Produto')['Quantidade'].sum()
    resumo.to_excel(writer, sheet_name="Resumo")

    # Criar an√°lise
    df_analise = df[df['Quantidade'] > 10]
    df_analise.to_excel(writer, sheet_name="Alta_Venda", index=False)

print("‚úÖ Relat√≥rio com m√∫ltiplas abas criado!")

# 3. Salvar com formata√ß√£o (usando openpyxl)
from openpyxl import load_workbook
from openpyxl.styles import Font

df.to_excel("formatado.xlsx", index=False)

# Abrir e formatar
wb = load_workbook("formatado.xlsx")
ws = wb.active

# Formatar cabe√ßalho
for cell in ws[1]:
    cell.font = Font(bold=True, size=12)

wb.save("formatado.xlsx")</code>
        </div>
    </div>

    <div class="slide">
                <h2><span class="emoji">‚úèÔ∏è</span>Exerc√≠cio Pr√°tico - Excel com Python</h2>

        <div class="exemplo-box">
                    <strong>üéØ Desafio: Sistema de Gest√£o de Produtos</strong>
                    <p>Crie um sistema que:</p>
                    <ol>
                        <li>Leia uma planilha de produtos</li>
                        <li>Calcule o valor total de estoque</li>
                        <li>Identifique produtos com estoque baixo (< 10)</li>
                        <li>Aplique 10% de desconto em produtos acima de R$ 500</li>
                        <li>Gere um relat√≥rio formatado com os resultados</li>
                    </ol>
                    <details>
                        <summary>Ver solu√ß√£o</summary>
                        <div class="code-block" style="margin-top: 10px;">
                            <code>import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import Font, PatternFill

# 1. Ler planilha
df = pd.read_excel("produtos.xlsx")

# 2. Calcular valor total
df['Total_Estoque'] = df['Quantidade'] * df['Pre√ßo']

# 3. Identificar estoque baixo
df['Alerta'] = df['Quantidade'].apply(
    lambda x: '‚ö†Ô∏è BAIXO' if x < 10 else '‚úÖ OK'
)

# 4. Aplicar desconto
df['Pre√ßo_Final'] = df['Pre√ßo'].apply(
    lambda x: x * 0.9 if x > 500 else x
)

# 5. Gerar relat√≥rio
df.to_excel("relatorio_produtos.xlsx", index=False)

# Formatar
wb = load_workbook("relatorio_produtos.xlsx")
ws = wb.active

for cell in ws[1]:
    cell.font = Font(bold=True, color="FFFFFF")
    cell.fill = PatternFill(start_color="4472C4",
                           end_color="4472C4",
                           fill_type="solid")

wb.save("relatorio_produtos.xlsx")
print("‚úÖ Relat√≥rio gerado com sucesso!")</code>
                        </div>
                    </details>
        </div>
    </div>

    <div class="slide">
                <h2><span class="emoji">üéì</span>Resumo - T√≥pico 5</h2>

        <div class="destaque">
                    <strong>üìö O que aprendemos:</strong>
            <ul style="margin-top: 10px;">
                        <li>‚úÖ Criar planilhas com <strong>Openpyxl</strong></li>
                        <li>‚úÖ Aplicar formata√ß√£o e estilos profissionais</li>
                        <li>‚úÖ Inserir f√≥rmulas do Excel</li>
                        <li>‚úÖ Ler e processar dados com <strong>Pandas</strong></li>
                        <li>‚úÖ Filtrar, ordenar e transformar dados</li>
                        <li>‚úÖ Agrupar e agregar informa√ß√µes</li>
                        <li>‚úÖ Salvar m√∫ltiplas abas e relat√≥rios</li>
            </ul>
        </div>

                <div class="exemplo-box">
                    <strong>üöÄ Pr√≥ximo passo:</strong>
                    No T√≥pico 6, vamos aprender a criar gr√°ficos incr√≠veis com Matplotlib
                    para visualizar nossos dados do Excel!
                </div>

                <div class="code-block">
                    <code># Exemplo completo resumido
import pandas as pd

# Ler
df = pd.read_excel("dados.xlsx")

# Analisar
df['Total'] = df['Qtd'] * df['Pre√ßo']
resumo = df.groupby('Categoria')['Total'].sum()

# Salvar
df.to_excel("resultado.xlsx", index=False)
print("‚úÖ Pronto!")</code>
        </div>
    </div>

    <div class="controles">
        <button class="btn btn-voltar-menu" onclick="voltarMenu()">‚Üê Voltar ao Menu</button>
        <button class="btn" onclick="slideAnterior()">‚Üê Anterior</button>
                <span class="contador-slides" id="contador9">1 / 24</span>
        <button class="btn" onclick="proximoSlide()">Pr√≥ximo ‚Üí</button>
    </div>
</div>
